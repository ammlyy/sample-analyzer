{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./src/App.vue?9b05","webpack:///./src/services/spectral-extractor/essentia-spectral-extractor.ts","webpack:///./src/services/sample-loader/sample-loader-impl.ts","webpack:///./src/ioc/registry.ts","webpack:///./src/ioc sync ^\\.\\/inversify\\..*\\.config$","webpack:///./src/assets/drums.wav","webpack:///./src/services/providers/quantizer.ts","webpack:///./src/components/harmony/HPCPPresenter.vue?8277","webpack:///./node_modules/moment/locale sync ^\\.\\/.*$","webpack:///./src/services/store/store.ts","webpack:///./src/ioc/inversify.development.config.ts","webpack:///./src/components/rhythm/WaveformPresenter.vue?3a60","webpack:///./src/services/time-extractor/essentia-time-extractor.ts","webpack:///./src/workers/essentia.ts","webpack:///./src/workers/essentia-message.ts","webpack:///./src/assets/cello.wav","webpack:///./src/ioc/index.ts","webpack:///./src/assets/rhodes.wav","webpack:///./src/App.vue?5627","webpack:///./src/components/sidebar/SampleLoader.vue?8a78","webpack:///./src/components/sidebar/SampleLoader.vue?5ddb","webpack:///./src/components/sidebar/SampleLoader.vue?f05f","webpack:///./src/components/sidebar/SampleLoader.vue","webpack:///./src/components/harmony/HarmonicStructure.vue?3f74","webpack:///./src/components/harmony/SpectrumPresenter.vue?3ef9","webpack:///./src/drawables/freqBox.ts","webpack:///./src/drawables/utils/logUtils.ts","webpack:///./src/drawables/spectra.ts","webpack:///./src/drawables/axis.ts","webpack:///./src/drawables/line.ts","webpack:///./src/components/harmony/SpectrumPresenter.vue?c3a7","webpack:///./src/components/harmony/SpectrumPresenter.vue?6f2a","webpack:///./src/components/harmony/SpectrumPresenter.vue","webpack:///./src/components/harmony/OvertonesPresenter.vue?8bc3","webpack:///./src/components/harmony/OvertonesPresenter.vue?5fac","webpack:///./src/components/harmony/OvertonesPresenter.vue?d843","webpack:///./src/components/harmony/OvertonesPresenter.vue","webpack:///./src/components/harmony/VoicingsPresenter.vue?a3a9","webpack:///./src/components/harmony/VoicingsPresenter.vue?b94f","webpack:///./src/components/harmony/VoicingsPresenter.vue?b4e5","webpack:///./src/components/harmony/VoicingsPresenter.vue","webpack:///./src/components/harmony/HPCPPresenter.vue?3290","webpack:///./src/components/harmony/HPCPPresenter.vue?f2a2","webpack:///./src/components/harmony/HPCPPresenter.vue?c8a8","webpack:///./src/components/harmony/HPCPPresenter.vue","webpack:///./src/components/harmony/HarmonicStructure.vue?6990","webpack:///./src/components/harmony/HarmonicStructure.vue?7522","webpack:///./src/components/harmony/HarmonicStructure.vue","webpack:///./src/components/rhythm/RhythmicStructure.vue?115f","webpack:///./src/components/rhythm/WaveformPresenter.vue?61d1","webpack:///./src/components/rhythm/AudioPlayer.vue?268e","webpack:///./src/components/rhythm/Legend.vue?228d","webpack:///./src/components/rhythm/Legend.vue?8754","webpack:///./src/components/rhythm/Legend.vue?1f1f","webpack:///./src/components/rhythm/Legend.vue","webpack:///./src/components/rhythm/AudioPlayer.vue?6729","webpack:///./src/components/rhythm/AudioPlayer.vue?521d","webpack:///./src/components/rhythm/AudioPlayer.vue","webpack:///./src/drawables/waveform.ts","webpack:///./src/components/rhythm/WaveformPresenter.vue?dbc3","webpack:///./src/components/rhythm/WaveformPresenter.vue?b9ac","webpack:///./src/components/rhythm/WaveformPresenter.vue","webpack:///./src/components/rhythm/SchemaPresenter.vue?7783","webpack:///./src/components/rhythm/SchemaPresenter.vue?be78","webpack:///./src/components/rhythm/SchemaPresenter.vue?75d5","webpack:///./src/components/rhythm/SchemaPresenter.vue","webpack:///./src/components/rhythm/SignaturesPresenter.vue?66ba","webpack:///./src/components/rhythm/SignaturesPresenter.vue?d865","webpack:///./src/components/rhythm/SignaturesPresenter.vue?b15b","webpack:///./src/components/rhythm/SignaturesPresenter.vue","webpack:///./src/components/rhythm/RhythmicStructure.vue?a457","webpack:///./src/components/rhythm/RhythmicStructure.vue?fc52","webpack:///./src/components/rhythm/RhythmicStructure.vue","webpack:///./src/App.vue?ec60","webpack:///./src/App.vue?640d","webpack:///./src/App.vue","webpack:///./src/plugins/vuetify.ts","webpack:///./src/main.ts","webpack:///./src/model/note.ts","webpack:///./src/services/providers/draw-toolkit.ts","webpack:///./src/services/providers/fft.ts","webpack:///./src/services/providers/context-provider.ts","webpack:///./src/services/providers/note-frequency.ts","webpack:///./src/components/harmony/SpectrumPresenter.vue?d355","webpack:///./src/ioc/inversify.production.config.ts"],"names":["webpackJsonpCallback","data","moduleId","chunkId","chunkIds","moreModules","executeModules","i","resolves","length","Object","prototype","hasOwnProperty","call","installedChunks","push","modules","parentJsonpFunction","shift","deferredModules","apply","checkDeferredModules","result","deferredModule","fulfilled","j","depId","splice","__webpack_require__","s","installedModules","exports","module","l","m","c","d","name","getter","o","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","p","jsonpArray","window","oldJsonpFunction","slice","EssentiaSpectralExtractor","sample","Promise","resolve","reject","worker","msg","HARMONY","postMessage","onmessage","event","isForMe","payload","max","Math","min","forEach","a","Float32Array","from","SampleLoaderImpl","this","context","createBuffer","url","fetch","then","response","arrayBuffer","buffer","decodeAudioData","audioBuffer","file","fr","FileReader","readAsArrayBuffer","onload","emptyBuffer","AudioContextProvider","REGISTRY","SpectralExtractor","for","TimeExtractor","NoteFrequencyProvider","SampleLoader","Store","DrawToolkit","Quantizer","FFT","map","webpackContext","req","id","webpackContextResolve","e","Error","code","keys","QuantizerImpl","array","bars","blocksize","floor","dataf","blockbegins","sum","abs","factor","StoreImpl","_sample","_timeAnalisis","emptySampleEvent","status","elapsed","_playing","_skipped","_polyAdded","_spectralpeaks","_hpcp","_fft","_loading","channel","getChannelData","b","numberOfChannels","_channelData","next","fft","of","spectrum","full","x","magnitude","frequency","sampleRate","spectralExtractor","analyze","subsampled","se","peaks","frequencies","hpcp","extractor","pe","skipped","PreLoadedStore","first","sampleExamples","sampleLoader","loadFromUrl","nextSample","addSingleton","EssentiaTimeExtractor","RHYTHM","normalize","Array","pos","start","end","envelope","attackSlope","decaySlope","Worker","EssentiaMessage","type","ID","random","toString","substr","reply","setID","message","clonedMessage","SPECTRUM","env","default","_vm","_h","$createElement","_c","_self","attrs","isLoading","on","$event","model","callback","$$v","drawer","expression","stopPropagation","_v","_s","_e","_l","tab","currentTab","staticRenderFns","staticClass","load","$set","item","domProps","selectSample","examples","store","subscribe","setLoading","ab","loadFromFile","component","ref","hover","hide","drawSpectrum","log","maxFreq","minFreq","scopedSlots","_u","fn","staticStyle","freqRange","proxy","freq","amplitude","xpos","ypos","visible","ctx","canvas","font","width","fillText","virtualCanvas","canvasWidth","offsetX","offset","translate","height","maxin","minin","maxout","minout","scaled","padding","nblocks","minFreqIndex","findIndex","sizing","y","log10","lineWidth","strokeStyle","beginPath","moveTo","lineTo","stroke","q","textFreq","graphicFreq","offsetHeight","widthpx","minDelta","idx","offsetWidth","strokeText","color","posx","sampleON","mainPanel","drawtoolkit","setUp","canvasspec","infoPanel","canvashov","mouseHandler","reset","getFFT","pipe","find","originalFFT","getSpectralPeaks","sp","spectralPeaks","freqBox","add","filteredFFT","filter","spectra","axis","redraw","peak","xbin","wrapperSpectrum","addEventListener","onMouseMove","offsetY","f","exp","toFixed","HTMLCanvasElement","HTMLDivElement","renderer","Renderer","score","Backends","SVG","resize","freshSVG","clear","notes","notemgt","freqToNote","drawTones","notesBASS","notesTREBLE","notesALTO","oct","substring","val","myclef","clefS","vexNote","clefRef","vexn","StaveNote","clef","duration","includes","addAccidental","Accidental","vexNotes","vexContexts","TREBLE","ALTO","BASS","vexVoice","Voice","num_beats","beat_value","setMode","addTickables","Formatter","format","draw","getContext","Stave","addClef","setContext","chordTypes","chordSelected","voicing","voicings","rhRender","lhRender","CENTRAL_NOTE","DEFAULT_OCTAVE","ACTUAL_CHORD","CHORD_TONES","chord","SCALE","methods","order","scorev","getHCPC","hcpc","HPCP","filtered","sort","fundamental","reduce","iMax","arr","moves","positionalCoef","createChords","drawChords","note","mod","chords","noteLefthand","noteRighthand","nota","toNote","parseInt","modifiers","hasModifier","staveright","staveleft","voiceT","voiceA","joinVoices","StaveConnector","setType","canvasChart","chart","Chart","labels","datasets","label","backgroundColor","borderColor","borderWidth","options","scales","yAxes","ticks","beginAtZero","dataset","update","components","SpectrumPresenter","OvertonesPresenter","VoicingsPresenter","HPCPPresenter","skip","sampletime","samplelng","playing","pause","play","paused","mute","changeVolume","volume","_g","dialog","ctxprovider","source","createBufferSource","rate","startplayingtime","pausedAt","onEnd","nextPlayEvent","restore","setup","clearInterval","interval","currentTime","setInterval","ceil","stop","gain","setValueAtTime","connect","createGain","newSample","destination","nextSkipped","Legend","strokeLine","GLOBALALPHA","previousblock","polyLines","canvasdom","canvasalpha","channelData","quantizer","lin","waveform","samplerate","inverseRatio","timeAnalysis","te","setUpInfoPanel","playingCursor","getPolyLine","console","v","mouseCursor","canvasWrapper","AudioPlayer","r1","r2","colorMask","color1","mask1","color2","mask2","directives","rawName","target","composing","_n","$forceUpdate","drawPoly","clearPoly","tuplets","POLYACTIVE","createMask","ta","drawRhythm","renderers","signature","splitBars","bar","drawBar","stave","addTimeSignature","setEndBarType","Barline","END","alert","lng","beat","subd","delta4","addPolyLine","left","modifier","setConfigForLines","_notes","toVexDuration","beams","Beam","generateBeams","FormatAndDraw","$root","$emit","mcm","mask","bpm","swing","minBpm","maxBpm","signatures","base","quarter","swingAmount","swings","time","maxSwing","calculateSignatures","WaveformPresenter","SchemaPresenter","SignaturesPresenter","loading","tabs","String","HarmonicStructure","RhythmicStructure","Loading","use","icons","iconfont","config","productionTip","vuetify","render","h","$mount","Notes","Quarter","ConstNote","octave","QuarterRythm","PanelImpl","elements","clearRect","callbackfn","pop","DrawToolkitImpl","alpha","dpr","devicePixelRatio","scale","globalAlpha","FFTEssentia","AudioContextProviderImpl","audioContext","AudioContext","NoteFrequencyProviderImpl","f0","NOTE","minNote","maxNote","step","pow","deltacents","deltanote","noteFrequency"],"mappings":"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X,UAAW,OACX,aAAc,OACd,UAAW,OACX,aAAc,OACd,UAAW,OACX,aAAc,OACd,UAAW,OACX,aAAc,OACd,UAAW,OACX,aAAc,OACd,UAAW,OACX,aAAc,OACd,UAAW,OACX,aAAc,OACd,OAAQ,OACR,UAAW,OACX,OAAQ,OACR,UAAW,OACX,aAAc,OACd,UAAW,OACX,aAAc,OACd,UAAW,OACX,OAAQ,OACR,UAAW,OACX,OAAQ,OACR,UAAW,OACX,OAAQ,OACR,UAAW,OACX,OAAQ,OACR,UAAW,OACX,OAAQ,OACR,UAAW,OACX,OAAQ,OACR,UAAW,OACX,aAAc,OACd,UAAW,OACX,aAAc,OACd,UAAW,OACX,OAAQ,OACR,UAAW,OACX,OAAQ,OACR,UAAW,OACX,OAAQ,OACR,UAAW,OACX,OAAQ,OACR,UAAW,OACX,aAAc,OACd,gBAAiB,OACjB,OAAQ,OACR,UAAW,OACX,OAAQ,OACR,UAAW,OACX,OAAQ,OACR,UAAW,OACX,OAAQ,OACR,UAAW,OACX,OAAQ,OACR,UAAW,OACX,UAAW,OACX,aAAc,OACd,OAAQ,OACR,UAAW,OACX,OAAQ,OACR,UAAW,OACX,OAAQ,OACR,UAAW,OACX,aAAc,OACd,UAAW,OACX,OAAQ,OACR,UAAW,OACX,OAAQ,OACR,UAAW,OACX,OAAQ,OACR,UAAW,OACX,OAAQ,OACR,UAAW,OACX,OAAQ,OACR,UAAW,OACX,OAAQ,OACR,UAAW,OACX,OAAQ,OACR,UAAW,OACX,OAAQ,OACR,UAAW,OACX,OAAQ,OACR,UAAW,OACX,OAAQ,OACR,UAAW,OACX,OAAQ,OACR,UAAW,OACX,OAAQ,OACR,UAAW,OACX,OAAQ,OACR,UAAW,OACX,OAAQ,OACR,UAAW,OACX,OAAQ,OACR,UAAW,OACX,OAAQ,OACR,UAAW,OACX,OAAQ,OACR,UAAW,OACX,OAAQ,OACR,UAAW,OACX,OAAQ,OACR,UAAW,OACX,OAAQ,OACR,UAAW,OACX,aAAc,OACd,UAAW,OACX,OAAQ,OACR,UAAW,OACX,OAAQ,OACR,UAAW,OACX,OAAQ,OACR,UAAW,OACX,OAAQ,OACR,UAAW,OACX,OAAQ,OACR,UAAW,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","file":"js/app.d3ca8d54.js","sourcesContent":[" \t// install a JSONP callback for chunk loading\n \tfunction webpackJsonpCallback(data) {\n \t\tvar chunkIds = data[0];\n \t\tvar moreModules = data[1];\n \t\tvar executeModules = data[2];\n\n \t\t// add \"moreModules\" to the modules object,\n \t\t// then flag all \"chunkIds\" as loaded and fire callback\n \t\tvar moduleId, chunkId, i = 0, resolves = [];\n \t\tfor(;i < chunkIds.length; i++) {\n \t\t\tchunkId = chunkIds[i];\n \t\t\tif(Object.prototype.hasOwnProperty.call(installedChunks, chunkId) && installedChunks[chunkId]) {\n \t\t\t\tresolves.push(installedChunks[chunkId][0]);\n \t\t\t}\n \t\t\tinstalledChunks[chunkId] = 0;\n \t\t}\n \t\tfor(moduleId in moreModules) {\n \t\t\tif(Object.prototype.hasOwnProperty.call(moreModules, moduleId)) {\n \t\t\t\tmodules[moduleId] = moreModules[moduleId];\n \t\t\t}\n \t\t}\n \t\tif(parentJsonpFunction) parentJsonpFunction(data);\n\n \t\twhile(resolves.length) {\n \t\t\tresolves.shift()();\n \t\t}\n\n \t\t// add entry modules from loaded chunk to deferred list\n \t\tdeferredModules.push.apply(deferredModules, executeModules || []);\n\n \t\t// run deferred modules when all chunks ready\n \t\treturn checkDeferredModules();\n \t};\n \tfunction checkDeferredModules() {\n \t\tvar result;\n \t\tfor(var i = 0; i < deferredModules.length; i++) {\n \t\t\tvar deferredModule = deferredModules[i];\n \t\t\tvar fulfilled = true;\n \t\t\tfor(var j = 1; j < deferredModule.length; j++) {\n \t\t\t\tvar depId = deferredModule[j];\n \t\t\t\tif(installedChunks[depId] !== 0) fulfilled = false;\n \t\t\t}\n \t\t\tif(fulfilled) {\n \t\t\t\tdeferredModules.splice(i--, 1);\n \t\t\t\tresult = __webpack_require__(__webpack_require__.s = deferredModule[0]);\n \t\t\t}\n \t\t}\n\n \t\treturn result;\n \t}\n\n \t// The module cache\n \tvar installedModules = {};\n\n \t// object to store loaded and loading chunks\n \t// undefined = chunk not loaded, null = chunk preloaded/prefetched\n \t// Promise = chunk loading, 0 = chunk loaded\n \tvar installedChunks = {\n \t\t\"app\": 0\n \t};\n\n \tvar deferredModules = [];\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"/sample-analyzer/\";\n\n \tvar jsonpArray = window[\"webpackJsonp\"] = window[\"webpackJsonp\"] || [];\n \tvar oldJsonpFunction = jsonpArray.push.bind(jsonpArray);\n \tjsonpArray.push = webpackJsonpCallback;\n \tjsonpArray = jsonpArray.slice();\n \tfor(var i = 0; i < jsonpArray.length; i++) webpackJsonpCallback(jsonpArray[i]);\n \tvar parentJsonpFunction = oldJsonpFunction;\n\n\n \t// add entry module to deferred list\n \tdeferredModules.push([0,\"chunk-vendors\"]);\n \t// run deferred modules when ready\n \treturn checkDeferredModules();\n","import mod from \"-!../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../node_modules/cache-loader/dist/cjs.js??ref--0-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./App.vue?vue&type=style&index=0&lang=css&\"; export default mod; export * from \"-!../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../node_modules/cache-loader/dist/cjs.js??ref--0-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./App.vue?vue&type=style&index=0&lang=css&\"","import { SpectralExtractor, SpectralAnalisis } from './spectral-extractor'\nimport { injectable } from 'inversify-props'\nimport { ConstNote } from '@/model/note'\n// @ts-ignore\nimport Worker from 'worker-loader!../../workers/essentia'\nimport { EssentiaMessage } from '@/workers/essentia-message'\n\n@injectable()\nexport class EssentiaSpectralExtractor implements SpectralExtractor {\n  analyze (sample: number[]): Promise<SpectralAnalisis> {\n    return new Promise((resolve, reject) => {\n      const worker = new Worker()\n      let msg:EssentiaMessage = new EssentiaMessage(EssentiaMessage.HARMONY, sample)\n      worker.postMessage(msg)\n      worker.onmessage = (event:MessageEvent) => {\n        if (msg.isForMe(event.data)) {\n          resolve(event.data.payload)\n        }\n      }\n    })\n  }\n\n  normalize (data:number[]):Float32Array {\n    let max = Math.max.apply(data)\n    let min = Math.min.apply(data)\n    data.forEach(a => a - min / (max - min))\n\n    return Float32Array.from(data)\n  }\n}\n","import { SampleLoaderService } from './sample-loader'\nimport { injectable, inject } from 'inversify-props'\nimport { REGISTRY } from '@/ioc/registry'\nimport { AudioContextProvider } from '../providers/context-provider'\n\n@injectable()\nexport class SampleLoaderImpl implements SampleLoaderService {\n  @inject(REGISTRY.AudioContextProvider) context: AudioContextProvider;\n\n  emptyBuffer():AudioBuffer {\n    return this.context.context().createBuffer(2, 1, 44100)\n  }\n\n\n  loadFromUrl (url: string):Promise<AudioBuffer> {\n    return new Promise<AudioBuffer>(resolve => {\n      fetch(url).then(response => {\n        response.arrayBuffer().then(buffer => {\n          this.context.context().decodeAudioData(buffer, audioBuffer => resolve(audioBuffer))\n        })\n      })\n    })\n  }\n\n  loadFromFile (file: File): Promise<AudioBuffer> {\n    return new Promise<AudioBuffer>(resolve => {\n      const fr = new FileReader()\n      fr.readAsArrayBuffer(file)\n      fr.onload = () => {\n        if (fr.result) {\n          this.context.context().decodeAudioData(fr.result as ArrayBuffer, audioBuffer => resolve(audioBuffer))\n        } else {\n          resolve(this.emptyBuffer())\n        }\n      }\n    })\n  }\n}\n","\nexport const REGISTRY = {\n  SpectralExtractor: Symbol.for('SpectralExtractor'),\n  TimeExtractor: Symbol.for('TimeExtractor'),\n  AudioContextProvider: Symbol.for('AudioContextProvider'),\n  NoteFrequencyProvider: Symbol.for('NoteFrequencyProvider'),\n  SampleLoader: Symbol.for('SampleLoader'),\n  Store: Symbol.for('Store'),\n  DrawToolkit: Symbol.for('DrawToolkit'),\n  Quantizer: Symbol.for('Quantizer'),\n  FFT: Symbol.for('FFT')\n}\n","var map = {\n\t\"./inversify.development.config\": \"4cbf\",\n\t\"./inversify.production.config\": \"fd69\"\n};\n\n\nfunction webpackContext(req) {\n\tvar id = webpackContextResolve(req);\n\treturn __webpack_require__(id);\n}\nfunction webpackContextResolve(req) {\n\tif(!__webpack_require__.o(map, req)) {\n\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\te.code = 'MODULE_NOT_FOUND';\n\t\tthrow e;\n\t}\n\treturn map[req];\n}\nwebpackContext.keys = function webpackContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackContext.resolve = webpackContextResolve;\nmodule.exports = webpackContext;\nwebpackContext.id = \"1cba\";","module.exports = __webpack_public_path__ + \"media/drums.c8e6d8d0.wav\";","import { injectable } from 'inversify-props'\n\nexport interface SpectrumPoint{\n  magnitude: number\n  frequency: number\n}\n\nexport interface Quantizer{\n  lin(array: number[], bars:number):number[]\n}\n\n@injectable()\nexport class QuantizerImpl implements Quantizer {\n  lin (array: number[], bars:number):number[] {\n    const blocksize = Math.floor(array.length / bars) // how many samples in each block\n    var dataf : number [] = [] // initialize the output\n\n    for (let i = 0; i < bars; i++) { // for each bar\n      let blockbegins = blocksize * i\n      let sum = 0\n\n      for (let j = 0; j < blocksize; j++) { // in each bar I sum up the values of each sample\n        sum = sum + Math.abs(array[blockbegins + j])\n      // sum\n      }\n      dataf.push(sum / blocksize) // pushes the average of each block into an array\n    }\n    const factor = Math.max(...dataf)\n    dataf = dataf.map(n => n * (1 / factor)) // average respect to the max\n    return dataf\n  }\n\n}\n","import mod from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./HPCPPresenter.vue?vue&type=style&index=0&id=1aef5a7a&lang=scss&scoped=true&\"; export default mod; export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./HPCPPresenter.vue?vue&type=style&index=0&id=1aef5a7a&lang=scss&scoped=true&\"","var map = {\n\t\"./af\": \"2bfb\",\n\t\"./af.js\": \"2bfb\",\n\t\"./ar\": \"8e73\",\n\t\"./ar-dz\": \"a356\",\n\t\"./ar-dz.js\": \"a356\",\n\t\"./ar-kw\": \"423e\",\n\t\"./ar-kw.js\": \"423e\",\n\t\"./ar-ly\": \"1cfd\",\n\t\"./ar-ly.js\": \"1cfd\",\n\t\"./ar-ma\": \"0a84\",\n\t\"./ar-ma.js\": \"0a84\",\n\t\"./ar-sa\": \"8230\",\n\t\"./ar-sa.js\": \"8230\",\n\t\"./ar-tn\": \"6d83\",\n\t\"./ar-tn.js\": \"6d83\",\n\t\"./ar.js\": \"8e73\",\n\t\"./az\": \"485c\",\n\t\"./az.js\": \"485c\",\n\t\"./be\": \"1fc1\",\n\t\"./be.js\": \"1fc1\",\n\t\"./bg\": \"84aa\",\n\t\"./bg.js\": \"84aa\",\n\t\"./bm\": \"a7fa\",\n\t\"./bm.js\": \"a7fa\",\n\t\"./bn\": \"9043\",\n\t\"./bn.js\": \"9043\",\n\t\"./bo\": \"d26a\",\n\t\"./bo.js\": \"d26a\",\n\t\"./br\": \"6887\",\n\t\"./br.js\": \"6887\",\n\t\"./bs\": \"2554\",\n\t\"./bs.js\": \"2554\",\n\t\"./ca\": \"d716\",\n\t\"./ca.js\": \"d716\",\n\t\"./cs\": \"3c0d\",\n\t\"./cs.js\": \"3c0d\",\n\t\"./cv\": \"03ec\",\n\t\"./cv.js\": \"03ec\",\n\t\"./cy\": \"9797\",\n\t\"./cy.js\": \"9797\",\n\t\"./da\": \"0f14\",\n\t\"./da.js\": \"0f14\",\n\t\"./de\": \"b469\",\n\t\"./de-at\": \"b3eb\",\n\t\"./de-at.js\": \"b3eb\",\n\t\"./de-ch\": \"bb71\",\n\t\"./de-ch.js\": \"bb71\",\n\t\"./de.js\": \"b469\",\n\t\"./dv\": \"598a\",\n\t\"./dv.js\": \"598a\",\n\t\"./el\": \"8d47\",\n\t\"./el.js\": \"8d47\",\n\t\"./en-SG\": \"cdab\",\n\t\"./en-SG.js\": \"cdab\",\n\t\"./en-au\": \"0e6b\",\n\t\"./en-au.js\": \"0e6b\",\n\t\"./en-ca\": \"3886\",\n\t\"./en-ca.js\": \"3886\",\n\t\"./en-gb\": \"39a6\",\n\t\"./en-gb.js\": \"39a6\",\n\t\"./en-ie\": \"e1d3\",\n\t\"./en-ie.js\": \"e1d3\",\n\t\"./en-il\": \"7333\",\n\t\"./en-il.js\": \"7333\",\n\t\"./en-nz\": \"6f50\",\n\t\"./en-nz.js\": \"6f50\",\n\t\"./eo\": \"65db\",\n\t\"./eo.js\": \"65db\",\n\t\"./es\": \"898b\",\n\t\"./es-do\": \"0a3c\",\n\t\"./es-do.js\": \"0a3c\",\n\t\"./es-us\": \"55c9\",\n\t\"./es-us.js\": \"55c9\",\n\t\"./es.js\": \"898b\",\n\t\"./et\": \"ec18\",\n\t\"./et.js\": \"ec18\",\n\t\"./eu\": \"0ff2\",\n\t\"./eu.js\": \"0ff2\",\n\t\"./fa\": \"8df4\",\n\t\"./fa.js\": \"8df4\",\n\t\"./fi\": \"81e9\",\n\t\"./fi.js\": \"81e9\",\n\t\"./fo\": \"0721\",\n\t\"./fo.js\": \"0721\",\n\t\"./fr\": \"9f26\",\n\t\"./fr-ca\": \"d9f8\",\n\t\"./fr-ca.js\": \"d9f8\",\n\t\"./fr-ch\": \"0e49\",\n\t\"./fr-ch.js\": \"0e49\",\n\t\"./fr.js\": \"9f26\",\n\t\"./fy\": \"7118\",\n\t\"./fy.js\": \"7118\",\n\t\"./ga\": \"5120\",\n\t\"./ga.js\": \"5120\",\n\t\"./gd\": \"f6b4\",\n\t\"./gd.js\": \"f6b4\",\n\t\"./gl\": \"8840\",\n\t\"./gl.js\": \"8840\",\n\t\"./gom-latn\": \"0caa\",\n\t\"./gom-latn.js\": \"0caa\",\n\t\"./gu\": \"e0c5\",\n\t\"./gu.js\": \"e0c5\",\n\t\"./he\": \"c7aa\",\n\t\"./he.js\": \"c7aa\",\n\t\"./hi\": \"dc4d\",\n\t\"./hi.js\": \"dc4d\",\n\t\"./hr\": \"4ba9\",\n\t\"./hr.js\": \"4ba9\",\n\t\"./hu\": \"5b14\",\n\t\"./hu.js\": \"5b14\",\n\t\"./hy-am\": \"d6b6\",\n\t\"./hy-am.js\": \"d6b6\",\n\t\"./id\": \"5038\",\n\t\"./id.js\": \"5038\",\n\t\"./is\": \"0558\",\n\t\"./is.js\": \"0558\",\n\t\"./it\": \"6e98\",\n\t\"./it-ch\": \"6f12\",\n\t\"./it-ch.js\": \"6f12\",\n\t\"./it.js\": \"6e98\",\n\t\"./ja\": \"079e\",\n\t\"./ja.js\": \"079e\",\n\t\"./jv\": \"b540\",\n\t\"./jv.js\": \"b540\",\n\t\"./ka\": \"201b\",\n\t\"./ka.js\": \"201b\",\n\t\"./kk\": \"6d79\",\n\t\"./kk.js\": \"6d79\",\n\t\"./km\": \"e81d\",\n\t\"./km.js\": \"e81d\",\n\t\"./kn\": \"3e92\",\n\t\"./kn.js\": \"3e92\",\n\t\"./ko\": \"22f8\",\n\t\"./ko.js\": \"22f8\",\n\t\"./ku\": \"2421\",\n\t\"./ku.js\": \"2421\",\n\t\"./ky\": \"9609\",\n\t\"./ky.js\": \"9609\",\n\t\"./lb\": \"440c\",\n\t\"./lb.js\": \"440c\",\n\t\"./lo\": \"b29d\",\n\t\"./lo.js\": \"b29d\",\n\t\"./lt\": \"26f9\",\n\t\"./lt.js\": \"26f9\",\n\t\"./lv\": \"b97c\",\n\t\"./lv.js\": \"b97c\",\n\t\"./me\": \"293c\",\n\t\"./me.js\": \"293c\",\n\t\"./mi\": \"688b\",\n\t\"./mi.js\": \"688b\",\n\t\"./mk\": \"6909\",\n\t\"./mk.js\": \"6909\",\n\t\"./ml\": \"02fb\",\n\t\"./ml.js\": \"02fb\",\n\t\"./mn\": \"958b\",\n\t\"./mn.js\": \"958b\",\n\t\"./mr\": \"39bd\",\n\t\"./mr.js\": \"39bd\",\n\t\"./ms\": \"ebe4\",\n\t\"./ms-my\": \"6403\",\n\t\"./ms-my.js\": \"6403\",\n\t\"./ms.js\": \"ebe4\",\n\t\"./mt\": \"1b45\",\n\t\"./mt.js\": \"1b45\",\n\t\"./my\": \"8689\",\n\t\"./my.js\": \"8689\",\n\t\"./nb\": \"6ce3\",\n\t\"./nb.js\": \"6ce3\",\n\t\"./ne\": \"3a39\",\n\t\"./ne.js\": \"3a39\",\n\t\"./nl\": \"facd\",\n\t\"./nl-be\": \"db29\",\n\t\"./nl-be.js\": \"db29\",\n\t\"./nl.js\": \"facd\",\n\t\"./nn\": \"b84c\",\n\t\"./nn.js\": \"b84c\",\n\t\"./pa-in\": \"f3ff\",\n\t\"./pa-in.js\": \"f3ff\",\n\t\"./pl\": \"8d57\",\n\t\"./pl.js\": \"8d57\",\n\t\"./pt\": \"f260\",\n\t\"./pt-br\": \"d2d4\",\n\t\"./pt-br.js\": \"d2d4\",\n\t\"./pt.js\": \"f260\",\n\t\"./ro\": \"972c\",\n\t\"./ro.js\": \"972c\",\n\t\"./ru\": \"957c\",\n\t\"./ru.js\": \"957c\",\n\t\"./sd\": \"6784\",\n\t\"./sd.js\": \"6784\",\n\t\"./se\": \"ffff\",\n\t\"./se.js\": \"ffff\",\n\t\"./si\": \"eda5\",\n\t\"./si.js\": \"eda5\",\n\t\"./sk\": \"7be6\",\n\t\"./sk.js\": \"7be6\",\n\t\"./sl\": \"8155\",\n\t\"./sl.js\": \"8155\",\n\t\"./sq\": \"c8f3\",\n\t\"./sq.js\": \"c8f3\",\n\t\"./sr\": \"cf1e\",\n\t\"./sr-cyrl\": \"13e9\",\n\t\"./sr-cyrl.js\": \"13e9\",\n\t\"./sr.js\": \"cf1e\",\n\t\"./ss\": \"52bd\",\n\t\"./ss.js\": \"52bd\",\n\t\"./sv\": \"5fbd\",\n\t\"./sv.js\": \"5fbd\",\n\t\"./sw\": \"74dc\",\n\t\"./sw.js\": \"74dc\",\n\t\"./ta\": \"3de5\",\n\t\"./ta.js\": \"3de5\",\n\t\"./te\": \"5cbb\",\n\t\"./te.js\": \"5cbb\",\n\t\"./tet\": \"576c\",\n\t\"./tet.js\": \"576c\",\n\t\"./tg\": \"3b1b\",\n\t\"./tg.js\": \"3b1b\",\n\t\"./th\": \"10e8\",\n\t\"./th.js\": \"10e8\",\n\t\"./tl-ph\": \"0f38\",\n\t\"./tl-ph.js\": \"0f38\",\n\t\"./tlh\": \"cf75\",\n\t\"./tlh.js\": \"cf75\",\n\t\"./tr\": \"0e81\",\n\t\"./tr.js\": \"0e81\",\n\t\"./tzl\": \"cf51\",\n\t\"./tzl.js\": \"cf51\",\n\t\"./tzm\": \"c109\",\n\t\"./tzm-latn\": \"b53d\",\n\t\"./tzm-latn.js\": \"b53d\",\n\t\"./tzm.js\": \"c109\",\n\t\"./ug-cn\": \"6117\",\n\t\"./ug-cn.js\": \"6117\",\n\t\"./uk\": \"ada2\",\n\t\"./uk.js\": \"ada2\",\n\t\"./ur\": \"5294\",\n\t\"./ur.js\": \"5294\",\n\t\"./uz\": \"2e8c\",\n\t\"./uz-latn\": \"010e\",\n\t\"./uz-latn.js\": \"010e\",\n\t\"./uz.js\": \"2e8c\",\n\t\"./vi\": \"2921\",\n\t\"./vi.js\": \"2921\",\n\t\"./x-pseudo\": \"fd7e\",\n\t\"./x-pseudo.js\": \"fd7e\",\n\t\"./yo\": \"7f33\",\n\t\"./yo.js\": \"7f33\",\n\t\"./zh-cn\": \"5c3a\",\n\t\"./zh-cn.js\": \"5c3a\",\n\t\"./zh-hk\": \"49ab\",\n\t\"./zh-hk.js\": \"49ab\",\n\t\"./zh-tw\": \"90ea\",\n\t\"./zh-tw.js\": \"90ea\"\n};\n\n\nfunction webpackContext(req) {\n\tvar id = webpackContextResolve(req);\n\treturn __webpack_require__(id);\n}\nfunction webpackContextResolve(req) {\n\tif(!__webpack_require__.o(map, req)) {\n\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\te.code = 'MODULE_NOT_FOUND';\n\t\tthrow e;\n\t}\n\treturn map[req];\n}\nwebpackContext.keys = function webpackContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackContext.resolve = webpackContextResolve;\nmodule.exports = webpackContext;\nwebpackContext.id = \"4678\";","import { Observable, BehaviorSubject, AsyncSubject } from 'rxjs'\nimport { map } from 'rxjs/operators'\nimport { injectable, inject } from 'inversify-props'\nimport { REGISTRY } from '@/ioc/registry'\nimport { SampleLoaderService } from '../sample-loader/sample-loader'\nimport { TimeAnalisis, TimeExtractor } from '../time-extractor/time-extractor'\nimport { FFT, FFTResponse } from '../providers/fft'\nimport { EssentiaSpectralExtractor } from '../spectral-extractor/essentia-spectral-extractor'\nimport { SpectrumPoint } from '../providers/quantizer'\n\nexport interface Example{\n  name: string,\n  url: string\n}\n\nexport interface Sample{\n  buffer: AudioBuffer\n  name: string\n}\n\nexport interface Store{\n    sample():Observable<Sample | null>\n    nextSample(sample:Sample):void\n    timeAnalysis():Observable<TimeAnalisis | null>\n    channelData ():Float32Array\n    playing ():Observable<PlayingEvent>\n    resetPlayEvent ():void\n    nextPlayEvent (pe:PlayingEvent):void\n    skipped():Observable<number | null>\n    nextSkipped(skipped:number):void\n    sampleExamples():Example[]\n    getPolyLine ():Observable<number[] | null>\n    addPolyLine (number:number[]):void\n    getSpectralPeaks ():Observable<number[] | null>\n    getHCPC ():Observable<number[] | null>\n    getFFT():Observable<SpectrumPoint[] | null>\n    loading():Observable<boolean>\n    setLoading():void\n}\n\nexport interface PlayingEvent{\n  status:boolean\n  length:number\n  elapsed:number\n}\n\n@injectable()\nexport class StoreImpl implements Store {\n    @inject(REGISTRY.SpectralExtractor) spectralExtractor: EssentiaSpectralExtractor\n    @inject(REGISTRY.TimeExtractor) extractor:TimeExtractor\n    @inject(REGISTRY.FFT) fft:FFT\n\n    protected _sample:BehaviorSubject<Sample | null> = new BehaviorSubject<Sample | null>(null);\n    protected _timeAnalisis:BehaviorSubject<TimeAnalisis | null> = new BehaviorSubject<TimeAnalisis | null>(null);\n\n    emptySampleEvent:PlayingEvent = { status: false, length: 0, elapsed: 0 }\n\n    private _playing:BehaviorSubject<PlayingEvent> = new BehaviorSubject<PlayingEvent>(this.emptySampleEvent);\n\n    protected _skipped:BehaviorSubject<number | null> = new BehaviorSubject<number | null>(null);\n\n    private _polyAdded = new BehaviorSubject<number[] | null>(null);\n    private _spectralpeaks = new BehaviorSubject<number[] | null>(null)\n    private _hpcp = new BehaviorSubject<number[] | null>(null)\n    private _fft = new BehaviorSubject<SpectrumPoint[] | null>(null)\n    private _loading = new BehaviorSubject<boolean>(true)\n\n    sample (): Observable<Sample | null> {\n      return this._sample\n    }\n\n    private _channelData (s:AudioBuffer):Float32Array {\n      let channel = s.getChannelData(0)\n      for (let j = 1; j < s.numberOfChannels; j++) {\n        let d = s.getChannelData(j)\n        channel = channel.map((a, b) => (a + d[b]) / s.numberOfChannels)\n      }\n      return channel\n    }\n\n    channelData ():Float32Array {\n      return this._sample.value ? this._channelData(this._sample.value.buffer) : Float32Array.from([0])\n    }\n\n    timeAnalysis (): Observable<TimeAnalisis | null> {\n      return this._timeAnalisis\n    }\n\n    nextSample (sample: Sample): void {\n      this._timeAnalisis.next(null)\n      this._hpcp.next(null)\n      this._spectralpeaks.next(null)\n      this._fft.next(null)\n      this._sample.next(sample)\n\n      var data = this._channelData(sample.buffer)\n\n      this.fft.of(data).then((spectrum:FFTResponse) => {\n        const fft = spectrum.full.map((x, i) => {\n          return { magnitude: x, frequency: i * ((sample.buffer.sampleRate / 2) / spectrum.full.length) }\n        })\n\n        this._fft.next(fft)\n\n        this.spectralExtractor.analyze(spectrum.subsampled).then(se => {\n          this._spectralpeaks.next(se.peaks.frequencies)\n          this._hpcp.next(se.hpcp)\n\n          this.extractor.analyze(data).then(a => {\n            this._timeAnalisis.next(a)\n            this._loading.next(false)\n          })\n        })\n      })\n    }\n\n    playing ():Observable<PlayingEvent> {\n      return this._playing\n    }\n\n    resetPlayEvent () {\n      this._playing.next(this.emptySampleEvent)\n    }\n\n    nextPlayEvent (pe:PlayingEvent) {\n      this._playing.next(pe)\n    }\n\n    skipped (): Observable<number | null> {\n      return this._skipped\n    }\n\n    nextSkipped (skipped : number): void {\n      this._skipped.next(skipped)\n    }\n\n    sampleExamples (): Example[] {\n      return [\n        { name: 'cello', url: require('@/assets/cello.wav') },\n        { name: 'drums', url: require('@/assets/drums.wav') },\n        { name: 'rhodes', url: require('@/assets/rhodes.wav') },\n      ]\n    }\n\n    getPolyLine ():Observable<number[] | null> { return this._polyAdded }\n    addPolyLine (n : number[]) { this._polyAdded.next(n) }\n\n    getSpectralPeaks ():Observable<number[] | null> { return this._spectralpeaks }\n    getHCPC (): Observable<number[] | null> { return this._hpcp }\n\n    getFFT (): Observable<SpectrumPoint[] | null> { return this._fft }\n\n    setLoading () {\n      this._loading.next(true)\n    }\n\n    loading ():Observable<boolean> {\n      return this._loading\n    }\n}\n\n@injectable()\nexport class PreLoadedStore extends StoreImpl {\n    @inject(REGISTRY.SampleLoader) sampleLoader:SampleLoaderService\n\n    constructor () {\n      super()\n      const first:Example = this.sampleExamples()[0]\n\n      this.sampleLoader.loadFromUrl(first.url).then(sample => {\n        this.nextSample({buffer: sample, name: first.name })\n      })\n    }\n}\n","import { SpectralExtractor } from '@/services/spectral-extractor/spectral-extractor'\nimport { DummySpectralExtractor } from '@/services/spectral-extractor/spectral-extractor-impl'\nimport { REGISTRY } from './registry'\nimport { container } from 'inversify-props'\nimport { AudioContextProviderImpl, AudioContextProvider } from '@/services/providers/context-provider'\nimport { SampleLoaderService } from '@/services/sample-loader/sample-loader'\nimport { SampleLoaderImpl } from '@/services/sample-loader/sample-loader-impl'\nimport { StoreImpl, Store, PreLoadedStore } from '@/services/store/store'\nimport { TimeExtractor } from '@/services/time-extractor/time-extractor'\nimport { DummyTimeExtractor } from '@/services/time-extractor/dummy-time-extractor'\nimport { DrawToolkit, DrawToolkitImpl } from '@/services/providers/draw-toolkit'\nimport { NoteFrequencyProvider, NoteFrequencyProviderImpl } from '@/services/providers/note-frequency'\nimport { Quantizer, QuantizerImpl } from '@/services/providers/quantizer'\nimport { FFTEssentia } from '@/services/providers/fft'\nimport { EssentiaTimeExtractor } from '@/services/time-extractor/essentia-time-extractor'\nimport { EssentiaSpectralExtractor } from '@/services/spectral-extractor/essentia-spectral-extractor'\n\nexport default function () {\n  container.addSingleton<SpectralExtractor>(EssentiaSpectralExtractor, REGISTRY.SpectralExtractor)\n  container.addSingleton<TimeExtractor>(EssentiaTimeExtractor, REGISTRY.TimeExtractor)\n  container.addSingleton<AudioContextProvider>(AudioContextProviderImpl, REGISTRY.AudioContextProvider)\n  container.addSingleton<NoteFrequencyProvider>(NoteFrequencyProviderImpl, REGISTRY.NoteFrequencyProvider)\n  container.addSingleton<SampleLoaderService>(SampleLoaderImpl, REGISTRY.SampleLoader)\n  container.addSingleton<Store>(PreLoadedStore, REGISTRY.Store)\n  container.addSingleton<DrawToolkit>(DrawToolkitImpl, REGISTRY.DrawToolkit)\n  container.addSingleton<Quantizer>(QuantizerImpl, REGISTRY.Quantizer)\n  container.addSingleton<FFTEssentia>(FFTEssentia, REGISTRY.FFT)\n};\n","import mod from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./WaveformPresenter.vue?vue&type=style&index=0&id=b0c45812&lang=scss&scoped=true&\"; export default mod; export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./WaveformPresenter.vue?vue&type=style&index=0&id=b0c45812&lang=scss&scoped=true&\"","import { injectable } from 'inversify-props'\nimport { TimeExtractor, TimeAnalisis } from './time-extractor'\n// @ts-ignore\nimport Worker from 'worker-loader!../../workers/essentia'\nimport { EssentiaMessage } from '@/workers/essentia-message'\n\n@injectable()\nexport class EssentiaTimeExtractor implements TimeExtractor {\n\n\n  analyze (sample: Float32Array): Promise<TimeAnalisis> {\n    return new Promise((resolve, reject) => {\n      const worker = new Worker()\n      let msg = new EssentiaMessage(EssentiaMessage.RHYTHM, this.normalize(Array.from(sample)))\n      worker.postMessage(msg)\n      worker.onmessage = (event:MessageEvent) => {\n        if (msg.isForMe(event.data)) {\n          let pos:number[] = Array.from(event.data.payload)\n          resolve({\n            start: 0,\n            end: 3,\n            peaks: pos,\n            envelope: [],\n            attackSlope: 2,\n            decaySlope: 0.3\n          })\n        }\n      }\n    })\n  }\n\n  normalize (data:number[]):Float32Array {\n    let max = Math.max.apply(data)\n    let min = Math.min.apply(data)\n    data.forEach(a => a - min / (max - min))\n\n    return Float32Array.from(data)\n  }\n}\n","module.exports = function() {\n  return new Worker(__webpack_public_path__ + \"a1d336f4af191cf5108b.worker.js\");\n};","export interface Message{\n    type:string\n    payload:any\n    reply (payload:any):Message\n    isForMe(message:Message):boolean\n}\n\nexport class EssentiaMessage implements Message {\n    static SPECTRUM = 'spectrum'\n    static RHYTHM = 'rhythm'\n    static HARMONY = 'harmony'\n\n    private ID:string;\n    type:string;\n    payload:any;\n\n    constructor (type:string, payload:any) {\n      this.ID = '_' + Math.random().toString(36).substr(2, 9)\n      this.type = type\n      this.payload = payload\n    }\n\n    static fromData (d:any) {\n      let clonedMessage = new EssentiaMessage(d.type, d.payload)\n      clonedMessage.setID(d.ID)\n      return clonedMessage\n    }\n\n    private setID (id:string) {\n      this.ID = id\n    }\n\n    reply (payload:any):Message {\n      let reply = new EssentiaMessage(this.type, payload)\n      reply.setID(this.ID)\n      return reply\n    }\n\n    isForMe (message: any): boolean {\n      if (message.ID) {\n        return message.ID === this.ID\n      }\n      return false\n    }\n}\n","module.exports = __webpack_public_path__ + \"media/cello.170fe634.wav\";","const env = process.env.NODE_ENV || 'development'\n\n// Register ioc\nrequire(`./inversify.${env}.config`).default()\n","module.exports = __webpack_public_path__ + \"media/rhodes.194f135b.wav\";","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('v-app',{attrs:{\"id\":\"inspire\"}},[_c('loading',{attrs:{\"active\":_vm.isLoading,\"can-cancel\":false,\"is-full-page\":true},on:{\"update:active\":function($event){_vm.isLoading=$event}}}),_c('v-navigation-drawer',{attrs:{\"app\":\"\",\"clipped\":\"\"},model:{value:(_vm.drawer),callback:function ($$v) {_vm.drawer=$$v},expression:\"drawer\"}},[_c('SampleLoader')],1),_c('v-app-bar',{attrs:{\"app\":\"\",\"clipped-left\":\"\"}},[_c('v-app-bar-nav-icon',{on:{\"click\":function($event){$event.stopPropagation();_vm.drawer = !_vm.drawer}}}),_c('v-toolbar-title',[_vm._v(\"Sample analyzer \"),(_vm.sample)?_c('span',[_vm._v(\"- \"+_vm._s(_vm.sample.name))]):_vm._e()])],1),_c('v-content',[_c('v-tabs',{attrs:{\"centered\":\"\",\"grow\":\"\"}},[_c('v-tabs-slider',{attrs:{\"color\":\"#1976D2\"}}),_vm._l((_vm.tabs),function(tab){return _c('v-tab',{key:tab,on:{\"click\":function($event){_vm.currentTab = tab}}},[_vm._v(\" \"+_vm._s(tab)+\" \")])}),_c('v-tab-item',[_c('HarmonicStructure')],1),_c('v-tab-item',[_c('RhythmicStructure')],1)],2)],1),_c('v-footer',{attrs:{\"app\":\"\"}},[_c('span',[_vm._v(\"© 2020\")])])],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('v-card',{staticClass:\"mx-auto\"},[_c('v-card-title',[_c('v-icon',{attrs:{\"large\":\"\",\"left\":\"\"}},[_vm._v(\"mdi-twitter\")]),_c('span',{staticClass:\"title font-weight-light\"},[_vm._v(\"Sample loader\")])],1),_c('v-card-text',[_c('v-file-input',{attrs:{\"label\":\"File input\"},on:{\"change\":_vm.load}}),_c('v-list',{attrs:{\"flat\":true}},[_c('v-subheader',[_vm._v(\"EXAMPLES\")]),_c('v-list-item-group',{attrs:{\"color\":\"primary\"},model:{value:(_vm.sample.name),callback:function ($$v) {_vm.$set(_vm.sample, \"name\", $$v)},expression:\"sample.name\"}},_vm._l((_vm.examples),function(item){return _c('v-list-item',{key:item.name},[_c('v-list-item-content',[_c('v-list-item-title',{domProps:{\"textContent\":_vm._s(item.name)},on:{\"click\":function($event){return _vm.selectSample(item)}}})],1)],1)}),1)],1)],1)],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nimport Vue from 'vue'\nimport { Component } from 'vue-property-decorator'\nimport { REGISTRY } from '../../ioc/registry'\nimport { inject } from 'inversify-props'\nimport { SampleLoaderService } from '../../services/sample-loader/sample-loader'\nimport { Store, Example, Sample } from '@/services/store/store'\n\n@Component\nexport default class SampleLoader extends Vue {\n  @inject(REGISTRY.SampleLoader) sampleLoader:SampleLoaderService;\n  @inject(REGISTRY.Store) store:Store\n\n  examples = this.store.sampleExamples()\n\n  sample:Sample = {buffer: this.sampleLoader.emptyBuffer(), name: ''}\n\n  mounted() {\n    this.store.sample().subscribe(s => {\n      if(s) {\n        this.sample = s\n      }\n    })\n  }\n\n  selectSample (s:Example) {\n    this.store.setLoading()\n    this.sampleLoader.loadFromUrl(s.url).then(ab => {\n      this.store.nextSample({buffer: ab, name: s.name})\n    })\n  }\n\n  load (file:File) {\n    this.store.setLoading()\n    this.sampleLoader.loadFromFile(file).then(ab => {\n      this.store.nextSample({buffer: ab, name: file.name})\n    })\n  }\n}\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/ts-loader/index.js??ref--13-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./SampleLoader.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/ts-loader/index.js??ref--13-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./SampleLoader.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./SampleLoader.vue?vue&type=template&id=c6d50f98&scoped=true&\"\nimport script from \"./SampleLoader.vue?vue&type=script&lang=ts&\"\nexport * from \"./SampleLoader.vue?vue&type=script&lang=ts&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"c6d50f98\",\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('v-container',{attrs:{\"fluid\":\"\"}},[_c('v-row',{attrs:{\"align\":\"center\",\"justify\":\"center\"}},[_c('SpectrumPresenter')],1),_c('v-row',{attrs:{\"align\":\"center\",\"justify\":\"center\"}},[_c('HPCPPresenter')],1),_c('v-row',{attrs:{\"align\":\"center\",\"justify\":\"center\"}},[_c('OvertonesPresenter')],1),_c('v-row',{attrs:{\"align\":\"center\",\"justify\":\"center\"}},[_c('VoicingsPresenter')],1)],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('v-container',{staticClass:\"col-12\"},[_c('v-row',{attrs:{\"align\":\"center\",\"justify\":\"center\"}},[_c('v-card',{staticClass:\"mx-auto col-10 mb-5 center\"},[_c('h2',[_vm._v(\"Spectrum\")]),_c('div',{ref:\"wrapper-spectrum\",staticClass:\"wrapper\",on:{\"mouseover\":function($event){_vm.hover = true},\"mouseleave\":_vm.hide}},[_c('canvas',{ref:\"hover\",staticClass:\"spectrum\"}),_c('canvas',{ref:\"spectrum\",staticClass:\"spectrum\"})]),_c('div',[_c('v-radio-group',{attrs:{\"row\":\"\"},on:{\"change\":function($event){return _vm.drawSpectrum()}},model:{value:(_vm.log),callback:function ($$v) {_vm.log=$$v},expression:\"log\"}},[_c('v-radio',{attrs:{\"label\":\"Log\",\"value\":true}}),_c('v-radio',{attrs:{\"label\":\"Lin\",\"value\":false}})],1)],1),_c('div',[_c('v-range-slider',{staticClass:\"align-center\",attrs:{\"max\":_vm.maxFreq,\"min\":_vm.minFreq,\"hide-details\":\"\"},on:{\"change\":function($event){return _vm.drawSpectrum()}},scopedSlots:_vm._u([{key:\"prepend\",fn:function(){return [_c('v-text-field',{staticClass:\"mt-0 pt-0\",staticStyle:{\"width\":\"60px\"},attrs:{\"value\":_vm.freqRange[0],\"hide-details\":\"\",\"single-line\":\"\",\"type\":\"number\"},on:{\"change\":function($event){return _vm.$set(_vm.freqRange, 0, $event)}}})]},proxy:true},{key:\"append\",fn:function(){return [_c('v-text-field',{staticClass:\"mt-0 pt-0\",staticStyle:{\"width\":\"60px\"},attrs:{\"value\":_vm.freqRange[1],\"hide-details\":\"\",\"single-line\":\"\",\"type\":\"number\"},on:{\"change\":function($event){return _vm.$set(_vm.freqRange, 1, $event)}}})]},proxy:true}]),model:{value:(_vm.freqRange),callback:function ($$v) {_vm.freqRange=$$v},expression:\"freqRange\"}})],1)])],1)],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","import { Drawable } from '@/services/providers/draw-toolkit'\n\nexport class FreqBox implements Drawable {\n  freq:string\n  amplitude:string\n  xpos:number\n  ypos:number\n  visible:boolean\n\n  constructor (freq:string, amplitude:string, xpos:number, ypos:number, visible:boolean) {\n    this.freq = freq\n    this.amplitude = amplitude\n    this.xpos = xpos\n    this.ypos = ypos\n    this.visible = visible\n  }\n\n  draw (ctx:CanvasRenderingContext2D, canvas:HTMLCanvasElement) {\n    if (this.visible) {\n      ctx.font = '10px verdana'\n      if (this.xpos + 50 <= canvas.width) {\n        ctx.fillText(this.freq, this.xpos, this.ypos + 35)\n      } else {\n        ctx.fillText(this.freq, this.xpos - 50, this.ypos + 35)\n      }\n    }\n  }\n}\n","export function virtualCanvas(canvasWidth:number,start:number,length:number):{width:number, offset:number} {\n    let width = canvasWidth\n    let offsetX = -(Math.log(start/length) / Math.log(width) * width + width)\n    while((width + offsetX - canvasWidth) < 0 && width < 10000) {\n        width += 10;\n        offsetX = -(Math.log(start/length) / Math.log(width) * width + width)\n    }\n    return {width: width, offset:offsetX}\n}","import { Drawable } from '@/services/providers/draw-toolkit'\nimport { SpectrumPoint } from '@/services/providers/quantizer'\nimport { virtualCanvas } from './utils/logUtils'\n\nexport class Spectra implements Drawable {\n    spectrum:SpectrumPoint[]\n    log:boolean = true\n    min: number = 40\n\n    constructor (spectrum:SpectrumPoint[],min:number,log:boolean) {\n      this.spectrum = spectrum\n      this.min = min\n      this.log = log\n    }\n\n    draw (ctx: CanvasRenderingContext2D, canvas:HTMLCanvasElement) {\n      \n      ctx.translate(0, canvas.height - 20) // canvas y axis to be on the bottom of the canvas |_|\n      \n      const maxin = Math.max(...this.spectrum.map(x => x.magnitude))\n      const minin = Math.min(...this.spectrum.map(x => x.magnitude))\n      const maxout = 10\n      const minout = 1\n      let scaled = this.spectrum.map(x => x.magnitude).map((a) => {\n        return (a - minin) * (maxout - minout) / (maxin - minin) + minout\n      })\n      let width = canvas.width\n      const height = canvas.height\n      const padding = -5\n      const nblocks = this.spectrum.length\n      let start = 0\n      let offsetX = -1000\n      if(this.log) {\n        const minFreqIndex = this.spectrum.findIndex(x => x.frequency > this.min)\n        start = minFreqIndex\n        const sizing = virtualCanvas(canvas.width,start,nblocks)\n        offsetX = sizing.offset\n        width = sizing.width\n      }\n      for (let i = start; i < nblocks; i++) {\n        let x = 0;\n        if(this.log) {\n          x = width + offsetX + (Math.log((i)/(nblocks)) / Math.log(width)) * width\n        } else { //linear\n          x = i / nblocks * width\n        }\n        \n        let y = Math.log10(scaled[i]) * height - padding\n\n        // drawing the line\n        ctx.lineWidth = 0.5\n        ctx.strokeStyle = '#034efc'\n        ctx.beginPath()\n        ctx.moveTo(x, 0)\n        ctx.lineTo(x, -y)\n        ctx.stroke()\n      }\n      ctx.translate(0, -(canvas.height - 20)) // Bring back Y = 0 to be in top of the canvas to match standard\n    }\n}\n","import { Drawable } from '@/services/providers/draw-toolkit'\nimport { SpectrumPoint } from '@/services/providers/quantizer'\nimport { of } from 'rxjs'\nimport { virtualCanvas } from './utils/logUtils'\n\nexport class Axis implements Drawable {\n    textFreq:string[]\n    graphicFreq: number[]\n    q:SpectrumPoint[]\n    max:number\n    log:boolean = true\n    min:number = 40\n\n    constructor (t:string[], n:number[], q:SpectrumPoint[], max:number, min:number, log:boolean) {\n      this.textFreq = t\n      this.graphicFreq = n\n      this.q = q\n      this.max = max\n      this.min = min\n      this.log =  log\n    }\n\n    draw (ctx:CanvasRenderingContext2D, canvas:HTMLCanvasElement) {\n      ctx.translate(0, canvas.offsetHeight - 20)\n      ctx.lineWidth = 1\n      ctx.beginPath()\n      ctx.moveTo(0, 0)\n      ctx.lineTo(canvas.width - 1, 0)\n      ctx.stroke()\n      ctx.moveTo(0, 0)\n      ctx.lineTo(1, -canvas.offsetHeight + 1)\n      ctx.stroke()\n      // frequency bins\n      for (let j = 0; j < this.graphicFreq.length; j++) {\n        if (this.graphicFreq[j] < this.max && this.graphicFreq[j] >= this.min) {\n          let widthpx = canvas.width // px width\n\n          let minDelta = Math.min(...this.q.map(x => Math.abs(x.frequency - this.graphicFreq[j])))\n          let idx = this.q.findIndex(x => x.frequency + minDelta === this.graphicFreq[j] || x.frequency - minDelta === this.graphicFreq[j])\n         \n          let pos = 0;\n\n          if(this.log) {\n            const minFreqIndex = this.q.findIndex(x => x.frequency > this.min)\n            const sizing = virtualCanvas(canvas.offsetWidth,minFreqIndex,this.q.length)\n            pos = sizing.width + sizing.offset + Math.log(idx/this.q.length) / Math.log(sizing.width) * sizing.width\n          } else {\n            pos = Math.floor(idx / this.q.length * widthpx)\n          }\n          ctx.lineWidth = 3\n          ctx.strokeStyle = 'black'\n          ctx.beginPath()\n          ctx.moveTo(pos, -4)\n          ctx.lineTo(pos, 4)\n          ctx.stroke()\n          ctx.lineWidth = 0.5\n          ctx.font = '8px verdana'\n          ctx.strokeText(this.textFreq[j], pos - 5, 15)\n        }\n      }\n      ctx.translate(0, -(canvas.offsetHeight - 20)) // Bring back Y = 0 to be in top of the canvas to match standard\n    }\n}\n","import { Drawable } from '@/services/providers/draw-toolkit'\nimport { virtualCanvas } from './utils/logUtils'\n\nexport class Line implements Drawable {\n  color:string\n  width:number\n  x: number // expressed in %, from 0 to 1\n  visible: boolean\n  log:boolean\n  start:number\n  length:number\n\n  constructor (color:string, width:number, x: number, visible: boolean, start?:number, length?:number) {\n    this.color = color\n    this.width = width\n    this.x = x\n    this.visible = visible\n    this.log = false\n    if(start && length) {\n      this.log = true\n      this.start = start\n      this.length = length\n    }\n  }\n\n\n  draw (ctx:CanvasRenderingContext2D) {\n    if (this.visible) {\n      ctx.strokeStyle = this.color\n      ctx.lineWidth = this.width\n      ctx.beginPath()\n      let posx = Math.floor(ctx.canvas.width * this.x)\n      if(this.log) {\n        const sizing = virtualCanvas(ctx.canvas.width,this.start,this.length)\n        posx = sizing.width + sizing.offset + Math.log(this.x) / Math.log(sizing.width) * sizing.width\n      }\n      \n      ctx.moveTo(posx, 0)\n      ctx.lineTo(posx, ctx.canvas.offsetHeight)\n      ctx.stroke()\n    }\n  }\n}\n","\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nimport Vue from 'vue'\nimport { Component, Ref } from 'vue-property-decorator'\nimport { Store } from '@/services/store/store'\nimport { AudioContextProvider } from '../../services/providers/context-provider'\nimport { inject } from 'inversify-props'\nimport { REGISTRY } from '@/ioc/registry'\nimport { EssentiaSpectralExtractor } from '@/services/spectral-extractor/essentia-spectral-extractor'\nimport { DrawToolkit, Panel } from '../../services/providers/draw-toolkit'\nimport { FreqBox } from '../../drawables/freqBox'\nimport { Spectra } from '../../drawables/spectra'\nimport { Axis } from '../../drawables/axis'\nimport { SpectrumPoint } from '../../services/providers/quantizer'\nimport { Line } from '../../drawables/line'\nimport { virtualCanvas } from '@/drawables/utils/logUtils'\nimport { SpectralAnalisis } from '../../services/spectral-extractor/spectral-extractor'\nimport { find } from 'rxjs/operators'\n\n@Component\nexport default class SpectrumPresenter extends Vue {\n    @inject(REGISTRY.Store) store:Store\n    @inject(REGISTRY.DrawToolkit) drawtoolkit:DrawToolkit\n    @Ref('spectrum') readonly canvasspec!: HTMLCanvasElement\n    @Ref('wrapper-spectrum') readonly wrapperSpectrum!:HTMLDivElement\n    @Ref('hover') readonly canvashov!:HTMLCanvasElement\n\n    private sample:AudioBuffer\n    private data:Float64Array\n    private originalFFT:SpectrumPoint[]\n    private filteredFFT:SpectrumPoint[]\n    private spectralPeaks:number[]\n    private graphicFreq: number[] = [100, 1000, 10000]\n    private textFreq:string[] = ['100', '1k', '10k'] // frequency references\n    public hover : boolean = true\n    private freqBox : FreqBox\n    private infoPanel: Panel\n    private mainPanel: Panel\n    private sampleON:boolean = false // manage mousehover when sample is still loading/offline/not loaded yet\n    private minFreq:number = 20\n    private maxFreq:number = 20000\n    private freqRange:number[] = [40, 10000]\n    private log:boolean = true\n\n    mounted () {\n      this.mainPanel = this.drawtoolkit.setUp(this.canvasspec, 1)\n      this.infoPanel = this.drawtoolkit.setUp(this.canvashov, 0.5)\n      this.mouseHandler()\n\n      this.store.sample().subscribe(ab => {\n        if (ab) {\n          this.mainPanel.reset()\n          this.infoPanel.reset()\n\n          this.maxFreq = ab.buffer.sampleRate / 2\n          this.freqRange = [40, this.maxFreq]\n          this.sample = ab.buffer\n\n          this.store.getFFT().pipe(find(x => x != null)).subscribe(fft => {\n            if (fft) {\n              this.originalFFT = fft\n              this.store.getSpectralPeaks().pipe(find(x => x != null)).subscribe(sp => {\n                if (sp) {\n                  this.spectralPeaks = sp\n                  this.drawSpectrum()\n                }\n              })\n            }\n          })\n        }\n      })\n    }\n\n    drawSpectrum () {\n      this.mainPanel.reset()\n      this.infoPanel.reset()\n\n      this.freqBox = new FreqBox('', '', 0, 0, false)\n      this.infoPanel.add(this.freqBox)\n\n      this.filteredFFT = this.originalFFT.filter(x => x.frequency < this.freqRange[1]) // linear works, checked with Matlab\n      if (!this.log) {\n        this.filteredFFT = this.filteredFFT.filter(x => x.frequency > this.freqRange[0])\n      }\n      let spectra = new Spectra(this.filteredFFT, this.freqRange[0], this.log)\n      this.mainPanel.add(spectra)\n      let axis = new Axis(this.textFreq, this.graphicFreq, this.filteredFFT, this.freqRange[1], this.freqRange[0], this.log)\n      this.mainPanel.add(axis)\n      this.mainPanel.redraw()\n\n      this.spectralPeaks.forEach(peak => {\n        // peak is in Hz, convert to log position\n        const start = this.filteredFFT.findIndex(x => x.frequency > this.freqRange[0]) // select next bin\n        const xbin = this.filteredFFT.findIndex(x => x.frequency > peak)\n        const xpos = xbin / this.filteredFFT.length\n        if (this.log) {\n          const o = new Line('red', 2, xpos, true, start, this.filteredFFT.length)\n          this.infoPanel.add(o)\n        } else {\n          const o = new Line('red', 2, xpos, true)\n          this.infoPanel.add(o)\n        }\n\n        this.sampleON = true\n      })\n      this.infoPanel.redraw()\n    }\n\n    // mouse event handler\n    mouseHandler () {\n      if (this.wrapperSpectrum) {\n        this.wrapperSpectrum.addEventListener('mousemove', this.onMouseMove)\n      }\n    }\n\n    onMouseMove (e: MouseEvent) {\n      if (this.freqBox && this.hover && this.sampleON) {\n        this.freqBox.xpos = e.offsetX * this.canvashov.width / this.canvashov.offsetWidth\n        this.freqBox.ypos = e.offsetY\n        this.freqBox.visible = true\n\n        if(this.log) {\n          const start = this.filteredFFT.findIndex(x => x.frequency > this.freqRange[0])\n          const sizing = virtualCanvas(this.canvashov.width, start, this.filteredFFT.length)\n\n          // Inversion of line.ts:35\n          let f = Math.exp((this.freqBox.xpos - sizing.width - sizing.offset) * Math.log(sizing.width) / sizing.width) * this.freqRange[1]\n\n          this.freqBox.freq = f.toFixed(2).toString() + ' Hz'\n        } else {\n\n          let f = e.offsetX / this.canvashov.offsetWidth * (this.freqRange[1] - this.freqRange[0]) + this.freqRange[0]\n          this.freqBox.freq = f.toFixed(2).toString() + ' Hz'\n        }\n\n        this.infoPanel.redraw()\n      }\n    }\n    hide () {\n      if (this.freqBox) {\n        this.freqBox.visible = false\n        this.infoPanel.redraw()\n      }\n    }\n}\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/ts-loader/index.js??ref--13-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./SpectrumPresenter.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/ts-loader/index.js??ref--13-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./SpectrumPresenter.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./SpectrumPresenter.vue?vue&type=template&id=064532f4&scoped=true&\"\nimport script from \"./SpectrumPresenter.vue?vue&type=script&lang=ts&\"\nexport * from \"./SpectrumPresenter.vue?vue&type=script&lang=ts&\"\nimport style0 from \"./SpectrumPresenter.vue?vue&type=style&index=0&id=064532f4&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"064532f4\",\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('v-container',{staticClass:\"col-12\"},[_c('v-row',{attrs:{\"align\":\"center\",\"justify\":\"center\"}},[_c('v-card',{staticClass:\"mx-auto col-10 mb-5 center\"},[_c('v-card-title',[_c('v-icon',{attrs:{\"large\":\"\",\"left\":\"\",\"color\":\"orange darken-2\"}},[_vm._v(\"fab fa-itunes-note\")]),_c('span',{staticClass:\"title font-weight-light\"},[_vm._v(\"Overtones presenter\")])],1),_c('v-card-text',[_vm._v(\"This is going to draw a pentagram with the overtones of the sound loaded.\")]),_c('v-row',{attrs:{\"align\":\"center\",\"justify\":\"center\"}},[_c('div',{ref:\"scoreh\",staticStyle:{\"background-color\":\"white\"}})])],1)],1)],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nimport Vue from 'vue'\nimport * as Vex from 'vexflow'\nimport { inject } from 'inversify-props'\nimport { REGISTRY } from '@/ioc/registry'\nimport { Store } from '@/services/store/store'\nimport { NoteFrequencyProvider } from '../../services/providers/note-frequency'\nimport { Component, Ref } from 'vue-property-decorator'\nimport { EssentiaSpectralExtractor } from '@/services/spectral-extractor/essentia-spectral-extractor'\n\n@Component\nexport default class OvertonesPresenter extends Vue {\n    @Ref('scoreh') score!:HTMLDivElement\n    @inject(REGISTRY.Store) store:Store\n    @inject(REGISTRY.NoteFrequencyProvider) notemgt:NoteFrequencyProvider\n    @inject(REGISTRY.SpectralExtractor) spectralExtractor: EssentiaSpectralExtractor;\n\n    private notes:String[]\n    private TREBLE:Vex.Flow.Stave\n    private ALTO:Vex.Flow.Stave\n    private BASS:Vex.Flow.Stave\n    private ctx:Vex.IRenderContext\n    private renderer:Vex.Flow.Renderer\n\n    mounted () {\n      this.renderer = new Vex.Flow.Renderer(this.score, Vex.Flow.Renderer.Backends.SVG)\n      this.renderer.resize(662, 350)\n      this.freshSVG()\n\n      this.store.getSpectralPeaks().subscribe(peaks => {\n        if (peaks) {\n          this.ctx.clear()\n          this.freshSVG()\n          this.notes = [] // empty the global variable\n\n          this.notes = peaks.map(a => this.notemgt.freqToNote(a))\n          this.drawTones(this.ctx)\n        }\n      })\n    }\n\n    drawTones (ctx:Vex.IRenderContext) {\n      var notesBASS:Vex.Flow.StaveNote[] = []\n      var notesTREBLE:Vex.Flow.StaveNote[] = []\n      var notesALTO:Vex.Flow.StaveNote[] = []\n\n      this.notes.forEach(n => {\n        let oct = n.substring(n.length - 1) // octave 4-5-6\n        let val = n.substring(0,1) // note value C-D-E\n        let myclef = this.clefS(oct) // string of the clef\n        let clefref = this.clefRef(oct)\n\n          const vexNote = val + '/' + oct\n          var vexn = new Vex.Flow.StaveNote({ clef: myclef, keys: [vexNote], duration: 'q' })\n\n          if(n.includes('#')) {\n            vexn.addAccidental(0,new Vex.Flow.Accidental('#'))\n          }\n\n          switch (myclef) {\n            case ('alto') : notesALTO.push(vexn); break\n            case ('treble') : notesTREBLE.push(vexn); break\n            default: notesBASS.push(vexn)\n          }\n      })\n\n      const vexNotes = [notesTREBLE,notesALTO,notesBASS]\n      const vexContexts = [this.TREBLE,this.ALTO,this.BASS]\n      \n      const vexVoice = vexNotes.filter(x => x.length > 0).map(x => {\n        return new Vex.Flow.Voice({ num_beats: 4, beat_value: 4 }).setMode(2).addTickables(x)\n      })\n      let formatter = new Vex.Flow.Formatter().format(vexVoice, 400)\n\n      vexNotes.forEach((x,i) => {\n        if(x.length > 0)\n          vexVoice[i].draw(ctx,vexContexts[i])\n      })\n\n    }\n\n    clefS (oct:string):string {\n      switch (oct) {\n        case '5': case '6': return 'treble'\n        case '4': case '3': return 'alto'\n        default: return 'bass'\n      }\n    }\n\n    clefRef (oct:string):Vex.Flow.Stave {\n      switch (oct) {\n        case '5': case '6': return this.TREBLE\n        case '4': case '3': return this.ALTO\n        default: return this.BASS\n      }\n    }\n\n    freshSVG () {\n      this.ctx = this.renderer.getContext()\n\n      this.TREBLE = new Vex.Flow.Stave(10, 40, 650)\n      this.TREBLE.addClef('treble')\n      this.TREBLE.setContext(this.ctx).draw()\n      this.ALTO = new Vex.Flow.Stave(10, 120, 650)\n      this.ALTO.addClef('alto')\n      this.ALTO.setContext(this.ctx).draw()\n      this.BASS = new Vex.Flow.Stave(10, 200, 650)\n      this.BASS.addClef('bass')\n      this.BASS.setContext(this.ctx).draw()\n\n      return this.renderer.getContext()\n    }\n}\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/ts-loader/index.js??ref--13-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./OvertonesPresenter.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/ts-loader/index.js??ref--13-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./OvertonesPresenter.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./OvertonesPresenter.vue?vue&type=template&id=6ddb90b6&\"\nimport script from \"./OvertonesPresenter.vue?vue&type=script&lang=ts&\"\nexport * from \"./OvertonesPresenter.vue?vue&type=script&lang=ts&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('v-container',{staticClass:\"col-12\"},[_c('v-row',{attrs:{\"align\":\"center\",\"justify\":\"center\"}},[_c('v-card',{staticClass:\"mx-auto col-10 mb-5 center\"},[_c('v-card-title',[_c('v-icon',{attrs:{\"large\":\"\",\"left\":\"\"}}),_c('span',{staticClass:\"title font-weight-light\"},[_vm._v(\"Suggested voicing\")])],1),_c('v-card-text',[_vm._v(\" Suggested voicing for specific sound loaded \"),_c('v-col',{staticClass:\"d-flex\",attrs:{\"cols\":\"6\"}},[_c('v-select',{attrs:{\"col-2\":\"\",\"label\":\"Select chord tones\",\"items\":_vm.chordTypes},on:{\"change\":_vm.chordSelected}})],1),_c('ul',_vm._l((_vm.voicings),function(voicing,i){return _c('li',{key:i},[_vm._v(_vm._s(voicing.name))])}),0)],1),_c('v-row',{attrs:{\"align\":\"center\",\"justify\":\"center\"}},[_c('div',{ref:\"scorevoice\",staticStyle:{\"background-color\":\"white\"}})])],1)],1)],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nimport Vue from 'vue'\nimport { Component, Ref } from 'vue-property-decorator'\nimport { inject } from 'inversify-props'\nimport { REGISTRY } from '@/ioc/registry'\nimport { Store } from '@/services/store/store'\nimport * as Vex from 'vexflow'\n\nexport interface VoicingDefinition{\n  name:string\n  chord: number[]\n}\n\nexport interface ChordTones{\n  type:string\n  chord:number[]\n}\n\n@Component\nexport default class VoicingsPresenter extends Vue {\n  @inject(REGISTRY.Store) store:Store\n  @Ref('scorevoice') scorev:HTMLDivElement\n  public renderer:Vex.Flow.Renderer\n  public voicings:VoicingDefinition[] = []\n  public rhRender:Vex.Flow.StaveNote[] = [] // right hand voicing\n  public lhRender:Vex.Flow.StaveNote[] = [] // left hand voicing\n  public CENTRAL_NOTE = 0\n  public DEFAULT_OCTAVE = 4\n  private TREBLE:Vex.Flow.Stave\n  private BASS:Vex.Flow.Stave\n  private ctx:Vex.IRenderContext\n  private ACTUAL_CHORD:string = ''\n  private HPCP:number[]\n\n  public chordTypes:string[] = ['maj6', 'maj7', 'dom7', 'm7', 'dim7']\n  public CHORD_TONES = [\n    { type: 'maj6', chord: [0, 4, 7, 9] },\n    { type: 'maj7', chord: [0, 4, 7, 11] },\n    { type: 'dom7', chord: [0, 4, 7, 10] },\n    { type: 'm7', chord: [0, 3, 7, 10] },\n    { type: 'dim7', chord: [0, 3, 6, 9] }\n  ]\n\n  private SCALE = ['C', 'C#', 'D', 'D#', 'E', 'F', 'F#', 'G', 'G#', 'A', 'A#', 'B']\n\n  private methods = [ // methods for chord inversion (growing order accomplished adding +10)\n    { type: '1st inversion', order: [-2, 11, 13, 14] },\n    { type: '2nd inversion', order: [-3, 4, 11, 12] },\n    { type: '3rd inversion', order: [-4, 11, 12, 13] }\n    //   { type: 'drop 2', order: [-3, 1, 2, 4] },\n  //  { type: 'drop 2&4', order: [-1, -3, 2, 4] }\n  ]\n\n  mounted () { // draw the lines\n    this.renderer = new Vex.Flow.Renderer(this.scorev, Vex.Flow.Renderer.Backends.SVG)\n    this.renderer.resize(630, 400)\n    this.freshSVG()\n\n    this.store.getHCPC().subscribe(hcpc => {\n      if (hcpc) {\n        this.HPCP = hcpc\n      }\n    })\n  }\n\n  private chordSelected (chord:string) {\n    let filtered = this.CHORD_TONES.filter(x => x.type === (chord))[0] // select type of chord with its guide tones\n    this.ctx.clear()\n    this.freshSVG()\n\n    // empty all the global variables on new sample loaded\n    this.rhRender = []\n    this.lhRender = []\n\n    const notes = [...filtered.chord].sort((a, b) => a - b) // sort them in increasing order\n\n    const fundamental = this.HPCP.reduce((iMax, x, i, arr) => x > arr[iMax] ? i : iMax, 0) // find the max index\n    const voicings = this.methods.map(x => { // iterate on all possible moves\n      let moves = x.order // how to move the note according to voicing rule\n      let name = x.type\n      let voicing = [] // preallocate rearrenged chord\n      for (let i = 0; i < moves.length; i++) {\n        let m = moves[i]\n        if (m > 0 && m < 10) { // no octave spacing m <10\n          voicing.push(notes[m - 1])\n        }\n        if (m > 0 && m > 10) { // octave spacing m>10\n          voicing.push(notes[m - 10 - 1] + 12) // one octave above\n        }\n        if (m < 0) {\n          voicing.push(notes[-m - 1] - 12) // one octave below\n        }\n      }\n\n      return { name: name,\n        chord: voicing,\n        score: voicing.map((y, i) => {\n          const positionalCoef:number = i === 0 ? 0.9 : 1 - i * 0.01\n          return positionalCoef * this.HPCP[(y + 12 + fundamental) % 12]\n        })\n          .reduce((x, y) => x + y) }\n    })\n      .sort((x, y) => y.score - x.score).slice(0, 3)\n    this.voicings = voicings.map(x => { return { name: x.name, chord: x.chord } })\n    this.createChords()\n    this.drawChords()\n  }\n\n  private toNote (note:number):string { // return a string representation of the note\n    let idx = note + this.CENTRAL_NOTE\n\n    if (idx < 0) {\n      return this.SCALE[mod(idx, 12)] + '/' + (this.DEFAULT_OCTAVE - 1).toString()// below octave\n    } if (idx >= 12) {\n      return this.SCALE[mod(idx, 12)] + '/' + (this.DEFAULT_OCTAVE + 1).toString() // octave above\n    } else {\n      return this.SCALE[mod(idx, 12)] + '/' + (this.DEFAULT_OCTAVE).toString() // same octave\n    }\n  }\n\n  private hasModifier (note:number):boolean { // return a string representation of the note\n    let idx = note + this.CENTRAL_NOTE\n    return this.SCALE[mod(idx, 12)].length > 1\n  }\n\n  private createChords () { // all the notes within the chord in semitone distances\n    let chords = this.voicings.map(a => a.chord)\n\n    chords.forEach(chord => { // for each chord\n      let noteLefthand:string[] = []\n      let noteRighthand:string[] = []\n      chord.forEach(note => { // for each note within the chord\n        let nota = this.toNote(note)\n        let oct = nota.slice(-1)\n        if (parseInt(oct) > 3) { noteRighthand.push(nota) } else { noteLefthand.push(nota) }\n      }) // once got the names of the note in an array of strings add the stavenote object to an array (octave splitting bw octaves)\n\n      const modifiers = chord.map(this.hasModifier)\n      let staveright = new Vex.Flow.StaveNote({ clef: 'treble',\n        keys: [...noteRighthand],\n        duration: '1' })\n\n      const staveNote = modifiers.slice(1).forEach((hasModifier, i) => {\n        if (hasModifier) {\n          return staveright.addAccidental(i, new Vex.Flow.Accidental('#'))\n        }\n      })\n\n      let staveleft = new Vex.Flow.StaveNote({ clef: 'bass', keys: [...noteLefthand], duration: '1' })\n      const staveNote2 = modifiers.slice(0, 1).forEach((hasModifier, i) => {\n        if (hasModifier) {\n          return staveleft.addAccidental(i, new Vex.Flow.Accidental('#'))\n        }\n      })\n      this.rhRender.push(staveright)\n      this.lhRender.push(staveleft)\n    })\n  }\n\n  private drawChords () {\n    // Create a voice in free mode and add the notes from above\n    let voiceT = new Vex.Flow.Voice({ num_beats: 4, beat_value: 4 }).setMode(2)\n    voiceT.addTickables(this.rhRender)\n    let voiceA = new Vex.Flow.Voice({ num_beats: 4, beat_value: 4 }).setMode(2)\n    voiceA.addTickables(this.lhRender)\n\n    // Format and justify the notes to 400 pixels.\n    var formatter = new Vex.Flow.Formatter().joinVoices([voiceT]).format([voiceT, voiceA], 400)\n\n    // Render voice\n    voiceA.draw(this.ctx, this.BASS)\n    voiceT.draw(this.ctx, this.TREBLE)\n  }\n\n  private freshSVG () {\n    this.ctx = this.renderer.getContext()\n    this.TREBLE = new Vex.Flow.Stave(25, 0, 600)\n    this.TREBLE.addClef('treble')\n    this.TREBLE.setContext(this.ctx).draw()\n    this.BASS = new Vex.Flow.Stave(25, 120, 600)\n    this.BASS.addClef('bass')\n    this.BASS.setContext(this.ctx).draw()\n\n    new Vex.Flow.StaveConnector(this.TREBLE, this.BASS).setType(3).setContext(this.ctx).draw() // 3 = brace\n    new Vex.Flow.StaveConnector(this.TREBLE, this.BASS).setType(1).setContext(this.ctx).draw()\n    new Vex.Flow.StaveConnector(this.TREBLE, this.BASS).setType(6).setContext(this.ctx).draw()\n\n    return this.renderer.getContext()\n  }\n\n  private redrawStave () {\n    this.renderer.getContext().clear()\n    this.freshSVG()\n    this.rhRender = []\n    this.lhRender = []\n\n    this.createChords()\n    this.drawChords()\n  }\n}\n\nfunction mod (n:number, m:number) {\n  return ((n % m) + m) % m\n}\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/ts-loader/index.js??ref--13-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./VoicingsPresenter.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/ts-loader/index.js??ref--13-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./VoicingsPresenter.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./VoicingsPresenter.vue?vue&type=template&id=5d0d4d24&\"\nimport script from \"./VoicingsPresenter.vue?vue&type=script&lang=ts&\"\nexport * from \"./VoicingsPresenter.vue?vue&type=script&lang=ts&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('v-container',{staticClass:\"col-12\"},[_c('v-row',{attrs:{\"align\":\"center\",\"justify\":\"center\"}},[_c('v-card',{staticClass:\"mx-auto col-10 mb-5 center\"},[_c('h2',[_vm._v(\"HPCP\")]),_c('div',{staticClass:\"chart\"},[_c('canvas',{ref:\"chart\",staticClass:\"chart\",attrs:{\"height\":\"285\"}})])])],1)],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nimport Vue from 'vue'\nimport { Component, Ref } from 'vue-property-decorator'\nimport { inject } from 'inversify-props'\nimport { REGISTRY } from '@/ioc/registry'\nimport { Store } from '@/services/store/store'\nimport { Chart } from 'chart.js'\n\n@Component\nexport default class HPCPPresenter extends Vue {\n    private chart:Chart\n\n    @Ref('chart') readonly canvasChart!: HTMLCanvasElement\n\n    @inject(REGISTRY.Store) store:Store\n\n    mounted () {\n      var ctx = this.canvasChart.getContext('2d')\n      if (ctx) {\n        this.chart = new Chart(ctx, {\n          type: 'bar',\n          data: {\n            labels: ['A', 'A#', 'B', 'C', 'C#', 'D', 'D#', 'E', 'F', 'F#', 'G', 'G#'],\n            datasets: [{\n              label: 'Note',\n              data: [],\n              backgroundColor: 'rgba(54, 162, 235, 0.2)',\n              borderColor: 'rgba(54, 162, 235, 1)',\n              borderWidth: 1\n            }]\n          },\n          options: {\n            scales: {\n              yAxes: [{\n                ticks: {\n                  beginAtZero: true\n                }\n              }]\n            }\n          }\n        })\n      }\n\n      this.store.getHCPC().subscribe(hcpc => {\n        if (this.chart) {\n          if (this.chart.data.datasets) {\n            this.chart.data.datasets.forEach((dataset:any) => {\n              dataset.data = hcpc || []\n            })\n            this.chart.update()\n          }\n        }\n      })\n    }\n}\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/ts-loader/index.js??ref--13-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./HPCPPresenter.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/ts-loader/index.js??ref--13-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./HPCPPresenter.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./HPCPPresenter.vue?vue&type=template&id=1aef5a7a&scoped=true&\"\nimport script from \"./HPCPPresenter.vue?vue&type=script&lang=ts&\"\nexport * from \"./HPCPPresenter.vue?vue&type=script&lang=ts&\"\nimport style0 from \"./HPCPPresenter.vue?vue&type=style&index=0&id=1aef5a7a&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"1aef5a7a\",\n  null\n  \n)\n\nexport default component.exports","\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nimport Vue from 'vue'\nimport { Component } from 'vue-property-decorator'\nimport SpectrumPresenter from './SpectrumPresenter.vue'\nimport OvertonesPresenter from './OvertonesPresenter.vue'\nimport VoicingsPresenter from './VoicingsPresenter.vue'\nimport HPCPPresenter from './HPCPPresenter.vue'\n\n@Component({\n  components: {\n    SpectrumPresenter,\n    OvertonesPresenter,\n    VoicingsPresenter,\n    HPCPPresenter\n  }\n})\nexport default class HarmonicStructure extends Vue {\n}\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/ts-loader/index.js??ref--13-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./HarmonicStructure.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/ts-loader/index.js??ref--13-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./HarmonicStructure.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./HarmonicStructure.vue?vue&type=template&id=8f97b172&scoped=true&\"\nimport script from \"./HarmonicStructure.vue?vue&type=script&lang=ts&\"\nexport * from \"./HarmonicStructure.vue?vue&type=script&lang=ts&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"8f97b172\",\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('v-container',{attrs:{\"fluid\":\"\"}},[_c('WaveformPresenter'),_c('v-row',[_c('SchemaPresenter')],1),_c('v-row',[_c('SignaturesPresenter')],1)],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('v-container',{staticClass:\"col-12\"},[_c('v-row',{attrs:{\"align\":\"center\",\"justify\":\"center\"}},[_c('v-card',{staticClass:\"mx-auto col-10 mt-5 space-around\"},[_c('div',{ref:\"canvas-wrapper\",staticClass:\"wrapper\",on:{\"mouseover\":function($event){_vm.hover = true},\"mouseleave\":_vm.hide,\"click\":_vm.skip}},[_c('canvas',{ref:\"waveform\",staticClass:\"waveform\"}),_c('canvas',{ref:\"waveformchild\",staticClass:\"waveform\"})])])],1),_c('v-row',{attrs:{\"align\":\"center\",\"justify\":\"center\"}},[_c('AudioPlayer')],1)],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('v-container',{staticClass:\"col-10\"},[_c('v-row',{staticClass:\"col-12 py-0\",attrs:{\"justify\":\"center\"}},[_c('v-slider',{attrs:{\"color\":\"#1976D2\",\"label\":(_vm.sampletime * _vm.samplelng / 100).toFixed(3)  + ' : ' +  _vm.samplelng.toFixed(3)},on:{\"click\":_vm.skip},model:{value:(_vm.sampletime),callback:function ($$v) {_vm.sampletime=$$v},expression:\"sampletime\"}})],1),_c('v-row',{staticClass:\"col-12 py-0\",attrs:{\"align-content\":\"center\",\"justify\":\"center\",\"dense\":\"\"}},[_c('v-col',{attrs:{\"cols\":\"1\"}},[_c('v-btn',{attrs:{\"text\":\"\",\"icon\":\"\",\"color\":\"#1976D2\"},on:{\"click\":function($event){_vm.playing ? _vm.pause() : _vm.play()}}},[(!_vm.playing || _vm.paused)?_c('v-icon',{attrs:{\"x-small\":\"\"}},[_vm._v(\"fas fa-play\")]):_c('v-icon',{attrs:{\"x-small\":\"\"}},[_vm._v(\"fas fa-pause\")])],1)],1),_c('v-col',{attrs:{\"cols\":\"1\"}},[_c('v-btn',{attrs:{\"text\":\"\",\"icon\":\"\",\"color\":\"#1976D2\"},on:{\"click\":function($event){return _vm.mute()}}},[_c('v-icon',{attrs:{\"x-small\":\"\"}},[_vm._v(\"fas fa-volume-up\")])],1)],1),_c('v-col',{attrs:{\"cols\":\"2\"}},[_c('v-slider',{attrs:{\"dark\":\"\",\"dense\":\"\",\"color\":\"#1976D2\",\"max\":\"1\",\"min\":\"0\",\"step\":\".1\"},on:{\"change\":_vm.changeVolume},model:{value:(_vm.volume),callback:function ($$v) {_vm.volume=$$v},expression:\"volume\"}})],1),_c('v-col',[_c('Legend',{staticClass:\"float-right\"})],1)],1)],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"text-center\"},[_c('v-dialog',{scopedSlots:_vm._u([{key:\"activator\",fn:function(ref){\nvar on = ref.on;\nreturn [_c('v-btn',_vm._g({attrs:{\"color\":\"blue\",\"dark\":\"\"}},on),[_vm._v(\" Legend \")])]}}]),model:{value:(_vm.dialog),callback:function ($$v) {_vm.dialog=$$v},expression:\"dialog\"}},[_c('v-card',[_c('v-card-title',{staticClass:\"headline grey lighten-2\",attrs:{\"primary-title\":\"\"}},[_vm._v(\" Legend \")]),_c('v-card-text',[_c('v-list-item',{attrs:{\"color\":\"blue\"}},[_c('v-icon',{staticClass:\"fas fa-square-full\",attrs:{\"color\":\"green\"}}),_c('v-list-item-title',[_vm._v(\" Peaks \")]),_c('v-icon',{staticClass:\"fas fa-square-full\",attrs:{\"color\":\"red\"}}),_c('v-list-item-title',[_vm._v(\" Playing sample \")]),_c('v-icon',{staticClass:\"fas fa-square-full\",attrs:{\"color\":\"yellow\"}}),_c('v-list-item-title',[_vm._v(\" Polyrhythm \")])],1)],1),_c('v-divider'),_c('v-card-actions',[_c('v-spacer'),_c('v-btn',{attrs:{\"color\":\"yellow\",\"text\":\"\"},on:{\"click\":function($event){_vm.dialog = false}}},[_vm._v(\" Close \")])],1)],1)],1)],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nimport Vue from 'vue'\nimport { Component } from 'vue-property-decorator'\n\n@Component\nexport default class Legend extends Vue {\n    private dialog:boolean = false\n}\n\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/ts-loader/index.js??ref--13-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Legend.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/ts-loader/index.js??ref--13-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Legend.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./Legend.vue?vue&type=template&id=36d4799e&\"\nimport script from \"./Legend.vue?vue&type=script&lang=ts&\"\nexport * from \"./Legend.vue?vue&type=script&lang=ts&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nimport Vue from 'vue'\nimport { Component } from 'vue-property-decorator'\nimport { inject } from 'inversify-props'\nimport { REGISTRY } from '@/ioc/registry'\nimport { Store, Sample } from '@/services/store/store'\nimport { AudioContextProvider } from '../../services/providers/context-provider'\nimport Legend from './Legend.vue'\n\n@Component({\n  components: {Legend}\n})\nexport default class AudioPlayer extends Vue {\n    private playing: boolean = false\n    private paused: boolean = true\n    private volume: number = 1\n    private sampletime: number = 0 // is going to change according to sample length (in ms?)\n\n    @inject(REGISTRY.Store) store:Store\n    @inject(REGISTRY.AudioContextProvider) ctxprovider:AudioContextProvider\n    private ctx = this.ctxprovider.context()\n    private source : AudioBufferSourceNode = this.ctx.createBufferSource()\n    private rate : number = this.ctx.sampleRate\n    private gain : GainNode\n    private samplelng : number = 0\n\n    private sample:AudioBuffer\n\n    private startplayingtime = 0;\n    private pausedAt = 0;\n    private interval:NodeJS.Timeout\n\n    mounted () {\n      this.store.skipped().subscribe(p => {\n        if (p) {\n          if (this.playing) {\n            this.pause()\n            this.onEnd()\n            this.sampletime = p\n            this.pausedAt = this.samplelng * p / 100\n            this.play()\n          } else {\n            this.sampletime = p\n            this.pausedAt = this.samplelng * p / 100\n            this.store.nextPlayEvent({ status: false, elapsed: this.pausedAt, length: this.samplelng })\n          }\n        }\n      })\n    }\n    private newSample (ab:Sample | null) {\n      if (ab) {\n        if (this.playing) {\n          this.pause()\n        }\n        this.sampletime = 0\n        this.pausedAt = 0\n        this.sample = ab.buffer\n        this.restore()\n        this.samplelng = ab.buffer.length / this.rate\n      }\n    }\n\n    created () {\n      this.setup()\n    }\n\n    onEnd () {\n      this.playing = false\n      clearInterval(this.interval)\n      this.restore()\n    }\n\n    play () {\n      this.paused = false\n      this.playing = true\n\n      this.startplayingtime = this.ctxprovider.context().currentTime\n      if (this.sampletime === 0) {\n        this.source.start()\n      }\n      if (this.sampletime > 0) {\n        this.source.start(0, this.pausedAt)\n      }\n\n      this.interval = setInterval(() => {\n        const elapsed = this.ctxprovider.context().currentTime - this.startplayingtime + this.pausedAt\n        this.sampletime = Math.ceil(elapsed / this.samplelng * 100)\n        this.store.nextPlayEvent({ status: this.playing, length: this.samplelng, elapsed: elapsed })\n        if (elapsed > this.samplelng) {\n          this.onEnd()\n          this.pausedAt = 0\n          this.sampletime = 0\n          this.store.nextPlayEvent({ status: false, elapsed: 0, length: this.samplelng })\n        }\n      }, 50)\n    }\n\n    pause () {\n      clearInterval(this.interval)\n      this.paused = true\n      this.playing = false\n      this.source.stop()\n      this.pausedAt = this.ctxprovider.context().currentTime - this.startplayingtime + this.pausedAt\n      this.store.nextPlayEvent({ length: this.samplelng, status: false, elapsed: this.pausedAt })\n\n      this.restore()\n    }\n\n    mute () {\n      if (this.volume !== 0) {\n        this.volume = 0\n        this.gain.gain.setValueAtTime(this.volume, this.ctx.currentTime)\n      } else {\n        this.volume = 0.25\n        this.gain.gain.setValueAtTime(this.volume, this.ctx.currentTime)\n      }\n    }\n\n    changeVolume () {\n      this.gain.gain.setValueAtTime(this.volume, this.ctx.currentTime)\n    }\n\n    restore () {\n      this.source = this.ctx.createBufferSource()\n      this.source.buffer = this.sample\n      this.source.connect(this.gain)\n    }\n\n    setup () {\n      this.gain = this.ctx.createGain()\n      this.gain.gain.setValueAtTime(this.volume, this.ctx.currentTime)\n      this.store.sample().subscribe(this.newSample)\n      this.source.connect(this.gain)\n      this.gain.connect(this.ctx.destination)\n    }\n\n    skip () {\n      let pos = this.sampletime\n      this.store.nextSkipped(pos)\n    }\n}\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/ts-loader/index.js??ref--13-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./AudioPlayer.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/ts-loader/index.js??ref--13-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./AudioPlayer.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./AudioPlayer.vue?vue&type=template&id=0daf5885&\"\nimport script from \"./AudioPlayer.vue?vue&type=script&lang=ts&\"\nexport * from \"./AudioPlayer.vue?vue&type=script&lang=ts&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","import { Drawable } from '@/services/providers/draw-toolkit'\n\nexport class Waveform implements Drawable {\n    data:number[]\n\n    constructor (data:number[]) {\n      this.data = data\n    }\n\n    draw (ctx:CanvasRenderingContext2D, canvas:HTMLCanvasElement) {\n      ctx.translate(0, canvas.height / 2) // Set Y = 0 to be in the middle of the canvas\n\n      const width = canvas.width / this.data.length\n\n      const height = canvas.height\n      const padding = 10\n      for (let i = 0; i < this.data.length; i++) {\n        let x = i * width\n        let y = this.data[i] * (height / 2) - padding\n\n        this.strokeLine(ctx, x, y)\n      }\n      ctx.translate(0, -(canvas.height / 2)) // Bring back Y = 0 to be in top of the canvas to match standards\n    }\n\n    strokeLine (ctx : CanvasRenderingContext2D, x : number, y : number) {\n      ctx.lineWidth = 1\n      ctx.strokeStyle = '#1976D2'\n      ctx.beginPath()\n      ctx.moveTo(x, 0)\n      ctx.lineTo(x, -y)\n      ctx.lineTo(x, y)\n      ctx.stroke()\n    }\n}\n","\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nimport Vue from 'vue'\nimport AudioPlayer from './AudioPlayer.vue'\n\nimport { Component, Ref } from 'vue-property-decorator'\nimport { inject } from 'inversify-props'\nimport { REGISTRY } from '@/ioc/registry'\nimport { Store } from '@/services/store/store'\nimport { AudioContextProvider } from '../../services/providers/context-provider'\nimport { TimeInterval } from 'rxjs'\nimport { DrawToolkit, Panel } from '../../services/providers/draw-toolkit'\nimport { Line } from '@/drawables/line'\nimport { Waveform } from '@/drawables/waveform'\nimport { Axis } from '@/drawables/axis'\nimport { EssentiaTimeExtractor } from '@/services/time-extractor/essentia-time-extractor'\nimport { Quantizer } from '../../services/providers/quantizer'\nimport { TimeExtractor } from '../../services/time-extractor/time-extractor'\n\n@Component({\n  components: { AudioPlayer,\n  }\n})\nexport default class WaveformPresenter extends Vue {\n  @inject(REGISTRY.Store) store:Store\n  @inject(REGISTRY.DrawToolkit) drawtoolkit:DrawToolkit\n  @inject(REGISTRY.Quantizer) quantizer:Quantizer\n  @Ref('waveform') readonly canvasdom!: HTMLCanvasElement\n  @Ref('waveformchild') readonly canvasalpha!: HTMLCanvasElement\n  @Ref('canvas-wrapper') readonly canvasWrapper!:HTMLDivElement\n\n  private dialog:boolean = false\n  private dataArray : Uint8Array\n  private data : number[]\n  private samplerate:number\n  private inverseRatio:number\n  public hover : boolean\n  private GLOBALALPHA : number = 0.7;\n  private bars = 800 // number of bars to plot\n  private previousInterval : NodeJS.Timeout\n  private previousblock : number = 0\n  private playingCursor:Line\n  private mouseCursor:Line\n  private mainPanel:Panel\n  private infoPanel:Panel\n  private polyLines:number = 0\n\n  mounted () { // access canvas\n    this.mainPanel = this.drawtoolkit.setUp(this.canvasdom, 1)\n    this.infoPanel = this.drawtoolkit.setUp(this.canvasalpha, this.GLOBALALPHA)\n\n    this.mouseHandler()\n\n    this.store.sample().subscribe(s => {\n      this.mainPanel.reset()\n      if (s) {\n        const channel = this.store.channelData()\n        this.data = this.quantizer.lin(Array.from(channel), this.bars)\n        let waveform = new Waveform(this.data)\n        this.mainPanel.add(waveform)\n        this.mainPanel.redraw()\n\n        this.samplerate = s.buffer.sampleRate\n        this.inverseRatio = 1 / s.buffer.duration\n        this.store.timeAnalysis().subscribe(te => {\n          this.setUpInfoPanel()\n          if (te) { // pass 32float array\n            te.peaks.forEach(peak => {\n              let xpos = peak * this.inverseRatio\n              let o = new Line('green', 2, xpos, true)\n              this.infoPanel.add(o)\n            })\n          }\n          this.infoPanel.redraw()\n        })\n      }\n    })\n\n    this.store.playing().subscribe(p => {\n      this.playingCursor.x = p.elapsed / p.length\n      this.playingCursor.visible = true\n      this.infoPanel.redraw()\n    })\n\n    this.store.skipped().subscribe(p => {\n      if (p) {\n        if (this.canvasalpha) {\n          this.playingCursor.visible = true\n          this.playingCursor.x = p / 100\n        }\n      }\n    })\n\n    this.store.getPolyLine().subscribe(val => {\n      console.log('calling filter')\n      if (val) {\n        if (this.canvasalpha) {\n          console.log('calling filter')\n          this.infoPanel.filter(x => {\n            console.log(x)\n            return (x as Line).color == 'yellow'? false : true\n          });\n          this.polyLines += val.length\n          val.forEach(v => {\n            let xpos = v * this.inverseRatio\n            let l = new Line('yellow', 3, xpos, true)\n            this.infoPanel.add(l)\n          })\n          this.infoPanel.redraw()\n        }\n      }\n    })\n\n    \n  }\n\n  private setUpInfoPanel () {\n    this.infoPanel.reset()\n    this.playingCursor = new Line('red', 3, 0, false)\n    this.mouseCursor = new Line('orange', 3, 0, false)\n    this.infoPanel.add(this.playingCursor)\n    this.infoPanel.add(this.mouseCursor)\n  }\n\n  // ANIMATION WITH MOUSE OVER\n  mouseHandler () {\n    if (this.canvasWrapper) {\n      this.canvasWrapper.addEventListener('mousemove', this.onMouseMove)\n    }\n  }\n\n  onMouseMove (e: MouseEvent) {\n    if (this.hover) {\n      this.mouseCursor.x = e.offsetX / this.canvasalpha.offsetWidth\n      this.mouseCursor.visible = true\n      this.infoPanel.redraw()\n    }\n  }\n\n  hide () {\n    this.mouseCursor.x = 0\n    this.mouseCursor.visible = false\n    this.infoPanel.redraw()\n  }\n\n  // click event managing, skips to another sample\n  skip (e: MouseEvent) {\n    let pos = Math.floor(e.offsetX / this.canvasalpha.offsetWidth * 100)\n    this.store.nextSkipped(pos)\n  }\n}\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/ts-loader/index.js??ref--13-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./WaveformPresenter.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/ts-loader/index.js??ref--13-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./WaveformPresenter.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./WaveformPresenter.vue?vue&type=template&id=b0c45812&scoped=true&\"\nimport script from \"./WaveformPresenter.vue?vue&type=script&lang=ts&\"\nexport * from \"./WaveformPresenter.vue?vue&type=script&lang=ts&\"\nimport style0 from \"./WaveformPresenter.vue?vue&type=style&index=0&id=b0c45812&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"b0c45812\",\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('v-container',{staticClass:\"col-12\"},[_c('v-row',{attrs:{\"align\":\"center\",\"justify\":\"center\"}},[_c('v-card',{staticClass:\"mx-auto col-10 mt-5 space-around\"},[_c('v-card-title',[_c('v-icon',{attrs:{\"large\":\"\",\"left\":\"\"}}),_c('span',{staticClass:\"title font-weight-light\"},[_vm._v(\"Rythmic schema\")])],1),_c('div',{ref:\"score\",staticStyle:{\"background-color\":\"white\",\"display\":\"none\"}}),_c('div',{staticClass:\"mb-6 col-12 d-flex justify-space-around\"},_vm._l(((this.r1*this.r2)),function(i){return _c('v-chip',{key:i,staticStyle:{\"color\":\"rgba(0,0,0,0)\"},attrs:{\"color\":_vm.colorMask(_vm.color1,_vm.mask1[i-1])}},[_vm._v(\"X\")])}),1),_c('div',{staticClass:\"mb-6 col-12 d-flex justify-space-around\"},_vm._l(((this.r1*this.r2)),function(i){return _c('v-chip',{key:i+10,staticStyle:{\"color\":\"rgba(0,0,0,0)\"},attrs:{\"color\":_vm.colorMask(_vm.color2,_vm.mask2[i-1])}},[_vm._v(\" x\")])}),1),_c('v-card-text',[_c('input',{directives:[{name:\"model\",rawName:\"v-model.number\",value:(_vm.r1),expression:\"r1\",modifiers:{\"number\":true}}],staticClass:\"text-center\",attrs:{\"placeholder\":\"?\"},domProps:{\"value\":(_vm.r1)},on:{\"input\":function($event){if($event.target.composing){ return; }_vm.r1=_vm._n($event.target.value)},\"blur\":function($event){return _vm.$forceUpdate()}}}),_vm._v(\" against :\"),_c('input',{directives:[{name:\"model\",rawName:\"v-model.number\",value:(_vm.r2),expression:\"r2\",modifiers:{\"number\":true}}],staticClass:\"text-center\",attrs:{\"placeholder\":\"?\"},domProps:{\"value\":(_vm.r2)},on:{\"input\":function($event){if($event.target.composing){ return; }_vm.r2=_vm._n($event.target.value)},\"blur\":function($event){return _vm.$forceUpdate()}}}),_c('v-btn',{on:{\"click\":_vm.drawPoly}},[_vm._v(\" Visualize possible polyrhythm \")]),_c('v-btn',{on:{\"click\":_vm.clearPoly,\"change\":_vm.clearPoly}},[_vm._v(\" Clear all \")])],1)],1)],1)],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nimport Vue from 'vue'\nimport { Component, Ref } from 'vue-property-decorator'\nimport * as Vex from 'vexflow'\nimport { NoteElement, QuarterRythm, Note, Quarter } from '@/model/note'\nimport { inject } from 'inversify-props'\nimport { REGISTRY } from '@/ioc/registry'\nimport { Store } from '@/services/store/store'\nimport { Color } from 'vuetify/lib/util/colors'\n\n@Component\nexport default class SchemaPresenter extends Vue {\n  @inject(REGISTRY.Store) store:Store\n  @Ref('score') score!:HTMLDivElement\n\n  r1 :number = 3;\n  r2 :number = 4;\n  peaks:number[] = [];\n  notes: any[] = [];\n  tuplets : any[] = []\n  renderer:Vex.Flow.Renderer;\n  ctx:Vex.IRenderContext\n  polystave:Vex.Flow.Stave\n  mask1:boolean[] = []\n  mask2:boolean[] = []\n  color1:string = 'green'\n  color2:string = 'yellow'\n  POLYACTIVE:boolean = false\n\n  mounted () {\n    this.createMask()\n    this.ctx = this.freshSVG()\n    this.store.timeAnalysis().subscribe(ta => {\n      if (ta) {\n        this.notes = [QuarterRythm] // clear notes with just initial beat\n        this.ctx.clear()\n        this.renderer.getContext().clear()\n        this.peaks = ta.peaks\n        this.peaks.forEach(() => this.notes.push(QuarterRythm))\n\n        this.drawRhythm(this.renderer.getContext(), this.notes, 10, this.r1.toString())\n      }\n    })\n  }\n\n  private freshSVG () {\n    let renderers = new Vex.Flow.Renderer(this.score, Vex.Flow.Renderer.Backends.SVG)\n    this.renderer = renderers\n    // Size our svg:\n    this.renderer.resize(1400, 300)\n    // And get a drawing context:\n    return this.renderer.getContext()\n  }\n\n  private drawRhythm (ctx:Vex.IRenderContext, notes:any[], height:number, signature:string) {\n    const bars = this.splitBars(notes)\n    const width = 400\n    bars.forEach((bar, i) => {\n      if (i === 0) {\n        this.drawBar(bar, 10, height, ctx, stave => stave.addClef('percussion').addTimeSignature(signature + '/' + 4))\n      } else if (i === (bars.length - 1)) {\n        this.drawBar(bar, i * width + 10, height, ctx, stave => stave.setEndBarType(Vex.Flow.Barline.type.END))\n      } else {\n        this.drawBar(bar, i * width + 10, height, ctx)\n      }\n    })\n\n    this.drawBar([], 410, height, ctx)\n  }\n\n  private drawPoly () {\n    this.clearPoly()\n    if (this.r1 % this.r2 === 0 || this.r2 % this.r1 === 0) return alert('This is not possible...')\n    if (this.r1 * this.r2 > 100) return alert('Tigran... is that you?')\n    this.POLYACTIVE = true\n    this.mask1 = []\n    this.mask2 = []\n    this.createMask()\n    let lng = this.peaks.length\n    let beat = this.peaks[this.r1 - 1] // 4th peak in 4against... , 3rd peak in 3 against\n    let subd = beat / this.r2\n    let idx = 0\n    let array = []\n    let delta4 = this.peaks[1] - this.peaks[0] // separation between beats in any time signature\n    while (idx * subd <= delta4 * (lng)) {\n      array.push(idx * subd)\n      idx++\n    }\n    this.store.addPolyLine(array)\n    this.drawRhythm(this.ctx, this.notes, 120, this.r2.toString())\n  }\n\n  private splitBars (notes:NoteElement[]):NoteElement[][] {\n    const result:NoteElement[][] = [[]]\n    let i = 0\n    notes.forEach(note => {\n      if (result[i].reduce((sum, x) => sum + (x.duration || 0), 0) >= 1) {\n        i++\n        result.push([])\n      }\n      result[i].push(note)\n    })\n    return result\n  }\n\n  private toVexDuration (n:number):string {\n    switch (n) {\n      case 0.25: return '4d'\n      default: return ''\n    }\n  }\n\n  private drawBar (notes:NoteElement[], left:number, height:number, context: Vex.IRenderContext, modifier: (stave:Vex.Flow.Stave) => void = (() => {})):void {\n    var stave = new Vex.Flow.Stave(left, height, 400).setConfigForLines(\n      [false, false, true, false, false].map(function (visible) {\n        return { visible: visible }\n      }))\n\n    modifier(stave)\n    // Connect it to the rendering context and draw!\n    stave.setContext(context).draw()\n\n    const _notes = notes.map(note => {\n      return new Vex.Flow.StaveNote({ clef: 'percussion', keys: ['b/4/x2'], duration: this.toVexDuration(note.duration) })\n    })\n\n    var beams = Vex.Flow.Beam.generateBeams(_notes)\n    Vex.Flow.Formatter.FormatAndDraw(context, stave, _notes)\n    beams.forEach(function (b) { b.setContext(context).draw() })\n  }\n\n  private clearPoly ():void{\n    this.$root.$emit('clearpoly')\n  }\n\n  private createMask () {\n    this.mask1 = []\n    this.mask2 = []\n\n    let mcm = this.r1 * this.r2\n\n    for (let i = 0; i < mcm; i++) {\n      if (i % this.r2 === 0 || i === 0) {\n        this.mask1.push(true)\n      } else { this.mask1.push(false) }\n    }\n\n    for (let i = 0; i < mcm; i++) {\n      if (i % this.r1 === 0 || i === 0) {\n        this.mask2.push(true)\n      } else { this.mask2.push(false) }\n    }\n    console.log(this.mask1)\n    console.log(this.mask2)\n  }\n\n  colorMask (color:string, mask:boolean) {\n    if (this.POLYACTIVE) {\n      if (mask) return color\n      else return 'grey'\n    } else return 'grey'\n  }\n\n  \n\n  deactivatePoly () {\n    this.POLYACTIVE = false\n  }\n}\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/ts-loader/index.js??ref--13-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./SchemaPresenter.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/ts-loader/index.js??ref--13-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./SchemaPresenter.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./SchemaPresenter.vue?vue&type=template&id=3de77470&\"\nimport script from \"./SchemaPresenter.vue?vue&type=script&lang=ts&\"\nexport * from \"./SchemaPresenter.vue?vue&type=script&lang=ts&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('v-container',{staticClass:\"col-12\"},[_c('v-row',{attrs:{\"align\":\"center\",\"justify\":\"center\"}},[_c('v-card',{staticClass:\"mx-auto col-10 mt-5 space-around\"},[_c('v-simple-table',{scopedSlots:_vm._u([{key:\"default\",fn:function(){return [_c('thead',[_c('tr',[_c('th',{staticClass:\"text-left\"},[_vm._v(\"BPM\")]),_c('th',{staticClass:\"text-left\"},[_vm._v(\"Swing\")])])]),_c('tbody',_vm._l((_vm.signatures),function(signature,i){return _c('tr',{key:i},[_c('td',[_vm._v(_vm._s(signature.bpm))]),_c('td',[_vm._v(_vm._s(signature.swing.toFixed(2)))])])}),0)]},proxy:true}])})],1)],1)],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nimport Vue from 'vue'\nimport { Component } from 'vue-property-decorator'\nimport { inject } from 'inversify-props'\nimport { REGISTRY } from '@/ioc/registry'\nimport { Store } from '@/services/store/store'\nimport { max } from 'rxjs/operators'\n\ninterface TimeSignature{\n  bpm:number,\n  swing: number\n}\n\n@Component\nexport default class SignaturePresenter extends Vue {\n  @inject(REGISTRY.Store) store:Store\n\n  minBpm = 40\n  maxBpm = 320\n\n  swing = 0.05\n  peaks:number[] = []\n\n  signatures:TimeSignature[] = []\n\n  calculateSignatures () {\n    if (this.peaks.length > 1) {\n      const base = this.peaks[0]\n      for (let bpm = this.minBpm; bpm < this.maxBpm; bpm += 0.5) {\n        const quarter = 60 / bpm // quarter length in seconds\n        const swingAmount = quarter * this.swing\n        const swings = this.peaks.map((time, i) => time - (base + i * quarter))\n        const maxSwing = Math.max(...swings.map(x => Math.abs(x)))\n        if (maxSwing < swingAmount) {\n          this.signatures.push({\n            bpm: bpm,\n            swing: maxSwing\n          })\n        }\n      }\n    }\n  }\n\n  created () {\n    this.store.timeAnalysis().subscribe(ta => {\n      this.signatures = []\n      if (ta) {\n        this.peaks = ta.peaks\n        this.calculateSignatures()\n      }\n    })\n  }\n\n}\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/ts-loader/index.js??ref--13-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./SignaturesPresenter.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/ts-loader/index.js??ref--13-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./SignaturesPresenter.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./SignaturesPresenter.vue?vue&type=template&id=51549291&\"\nimport script from \"./SignaturesPresenter.vue?vue&type=script&lang=ts&\"\nexport * from \"./SignaturesPresenter.vue?vue&type=script&lang=ts&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","\n\n\n\n\n\n\n\n\n\n\n\n\nimport Vue from 'vue'\nimport { Component } from 'vue-property-decorator'\nimport WaveformPresenter from './WaveformPresenter.vue'\nimport AudioPlayer from './AudioPlayer.vue'\nimport SchemaPresenter from './SchemaPresenter.vue'\nimport SignaturesPresenter from './SignaturesPresenter.vue'\n\n@Component({\n  components: { WaveformPresenter,\n    AudioPlayer,\n    SchemaPresenter,\n    SignaturesPresenter\n  }\n\n})\nexport default class RhythmicStructure extends Vue {\n}\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/ts-loader/index.js??ref--13-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./RhythmicStructure.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/ts-loader/index.js??ref--13-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./RhythmicStructure.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./RhythmicStructure.vue?vue&type=template&id=55e0a02f&\"\nimport script from \"./RhythmicStructure.vue?vue&type=script&lang=ts&\"\nexport * from \"./RhythmicStructure.vue?vue&type=script&lang=ts&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nimport Vue from 'vue'\nimport { Component, Prop } from 'vue-property-decorator'\nimport SampleLoader from './components/sidebar/SampleLoader.vue'\nimport HarmonicStructure from './components/harmony/HarmonicStructure.vue'\nimport RhythmicStructure from './components/rhythm/RhythmicStructure.vue'\n// @ts-ignore\nimport Loading from 'vue-loading-overlay'\nimport 'vue-loading-overlay/dist/vue-loading.css'\nimport { inject } from 'inversify-props'\nimport { REGISTRY } from './ioc/registry'\nimport { Store, Sample } from './services/store/store'\n\n@Component({\n  components: {\n    SampleLoader,\n    HarmonicStructure,\n    RhythmicStructure,\n    Loading\n  }\n})\nexport default class App extends Vue {\n  @inject(REGISTRY.Store) store:Store\n\n  created () {}\n\n  drawer = false;\n  isLoading = true;\n\n  sample:Sample | null = null;\n\n  @Prop(String) source: string;\n\n  mounted () {\n    this.store.loading().subscribe(x => this.isLoading = x)\n    this.store.sample().subscribe(s => this.sample = s)\n  }\n\n  data () {\n    return {\n      currentTab: 'Harmony',\n      tabs: ['Harmony', 'Rhythm']\n    }\n  }\n  computed () {}\n}\n","import mod from \"-!../node_modules/cache-loader/dist/cjs.js??ref--13-0!../node_modules/thread-loader/dist/cjs.js!../node_modules/babel-loader/lib/index.js!../node_modules/ts-loader/index.js??ref--13-3!../node_modules/cache-loader/dist/cjs.js??ref--0-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./App.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../node_modules/cache-loader/dist/cjs.js??ref--13-0!../node_modules/thread-loader/dist/cjs.js!../node_modules/babel-loader/lib/index.js!../node_modules/ts-loader/index.js??ref--13-3!../node_modules/cache-loader/dist/cjs.js??ref--0-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./App.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./App.vue?vue&type=template&id=191213f2&\"\nimport script from \"./App.vue?vue&type=script&lang=ts&\"\nexport * from \"./App.vue?vue&type=script&lang=ts&\"\nimport style0 from \"./App.vue?vue&type=style&index=0&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","import Vue from 'vue'\nimport Vuetify from 'vuetify'\nimport 'vuetify/dist/vuetify.min.css'\nimport '@fortawesome/fontawesome-free/css/all.css'\n\nVue.use(Vuetify)\n\nexport default new Vuetify({\n  icons: {\n    iconfont: 'fa'\n  }\n\n})\n","import 'reflect-metadata' // Import only once\nimport Vue from 'vue'\nimport App from './App.vue'\nimport vuetify from './plugins/vuetify'\nimport './ioc'\n\nVue.config.productionTip = false\n\nnew Vue({\n  vuetify,\n  render: h => h(App)\n}).$mount('#app')\n","\ntype NoteName = 'C' | 'C#' | 'D' | 'D#' | 'E' | 'F' | 'F#' | 'G' | 'G#' | 'A' | 'A#' | 'B';\n\nexport interface Note{\n    name: NoteName;\n    octave: number;\n    frequency: number;\n}\n\nexport const Notes:NoteName[] = ['A', 'A#', 'B', 'C', 'C#', 'D', 'D#', 'E', 'F', 'F#', 'G', 'G#']\n\nexport interface NoteElement{\n    duration:number\n    note?:Note\n    pause:boolean\n}\n\nexport class Quarter implements NoteElement {\n  constructor (n:Note) {\n    this.note = n\n  }\n    duration = 0.25\n    note:Note\n    pause = false\n}\n\nexport class QuarterPause implements NoteElement {\n    duration = 0.25\n    pause = true\n}\n\nexport const ConstNote:Note = { name: 'B', octave: 0, frequency: 0 }\n\nexport const QuarterRythm = new Quarter(ConstNote)\n","import { injectable } from 'inversify-props'\n\nexport interface Drawable {\n  draw(ctx:CanvasRenderingContext2D, canvas:HTMLCanvasElement):void;\n}\n\nexport interface DrawToolkit {\n\n    setUp(canvas : HTMLCanvasElement, alpha : number):Panel;\n\n}\n\nexport interface Panel {\n  redraw():void;\n  add(d:Drawable):void;\n  reset():void\n  remove():void;\n  filter(callbackfn: (value: Drawable, index: number, array: Drawable[]) => boolean):void;\n}\n\nexport class PanelImpl implements Panel {\n  private elements:Drawable[] = [];\n  private canvas:HTMLCanvasElement;\n\n  constructor (canvas: HTMLCanvasElement) {\n    this.canvas = canvas\n  }\n\n  redraw ():void {\n    const ctx = this.canvas.getContext('2d')\n    if (ctx) {\n      ctx.clearRect(0, 0, this.canvas.width, this.canvas.height)\n      this.elements.forEach(d => d.draw(ctx, this.canvas))\n    }\n  }\n\n  add (d:Drawable):void {\n    this.elements.push(d)\n  }\n\n  filter(callbackfn: (value: Drawable, index: number, array: Drawable[]) => boolean):void {\n    console.log('filter')\n    this.elements = this.elements.filter(callbackfn)\n  }\n\n  remove ():void{\n    this.elements.pop()\n  }\n\n  reset ():void{\n    this.elements = []\n  }\n}\n\n@injectable()\nexport class DrawToolkitImpl implements DrawToolkit {\n  setUp (canvas : HTMLCanvasElement, alpha : number) {\n    const ctx = canvas.getContext('2d')\n    if (ctx) {\n      const dpr = window.devicePixelRatio || 1\n      canvas.width = canvas.offsetWidth * dpr\n      canvas.height = (canvas.offsetHeight) * dpr\n      ctx.scale(dpr, dpr)\n      ctx.globalAlpha = alpha\n      return new PanelImpl(canvas)\n    }\n    throw new Error('Canvas not ready')\n  }\n}\n","import { injectable } from 'inversify-props'\n// @ts-ignore\nimport Worker from 'worker-loader!../../workers/essentia'\nimport { EssentiaMessage } from '@/workers/essentia-message'\n\nexport interface FFT{\n  of(data:Float32Array):Promise<FFTResponse>;\n}\n\nexport interface FFTResponse{\n  full:number[];\n  subsampled:number[];\n}\n\n@injectable()\nexport class FFTEssentia implements FFT {\n  of (data:Float32Array):Promise<FFTResponse> {\n    return new Promise((resolve, reject) => {\n      const worker = new Worker()\n      let msg:EssentiaMessage = new EssentiaMessage(EssentiaMessage.SPECTRUM, Array.from(data))\n      worker.postMessage(msg)\n      worker.onmessage = (event:MessageEvent) => {\n        if (msg.isForMe(event.data)) {\n          resolve(event.data.payload)\n        }\n      }\n    })\n  }\n}\n","import { injectable } from 'inversify-props'\n\nexport interface AudioContextProvider {\n    context():AudioContext;\n}\n\n@injectable()\nexport class AudioContextProviderImpl implements AudioContextProvider {\n    private audioContext = new AudioContext({\n      sampleRate: 44100\n    });\n\n    context (): AudioContext {\n      return this.audioContext\n    }\n}\n","import { injectable } from 'inversify-props'\nimport { Note, Notes } from '@/model/note'\n\nexport interface NoteWeigth{\n  note:Note\n  magnitude: number\n}\n\nexport interface NoteFrequencyProvider {\n    allNotes():Note[];\n    freqToNote(f:number):String;\n}\n\n@injectable()\nexport class NoteFrequencyProviderImpl implements NoteFrequencyProvider {\n  private f0 = 440;\n  private NOTE = ['A', 'A#', 'B', 'C', 'C#', 'D', 'D#', 'E', 'F', 'F#', 'G', 'G#']\n\n  private minNote = -60 // correspond to 13.75 Hz\n  private maxNote = 65 // 19 ~kHz\n\n  private noteFrequency (step:number):number {\n    return this.f0 * Math.pow(2, step / 12)\n  }\n\n  freqToNote (freq:number):String {\n    let deltacents = Math.floor(1200 * Math.log(freq / this.f0) / Math.log(2)) // cents formula\n    let deltanote = Math.floor(deltacents / 100) // 100 cents = 1 semitone\n    if (deltanote % 100 > 50) { deltanote++ }\n\n    let note = deltanote + 48 // count semitones starting from c0 - 16.35Hz\n    let octave = Math.ceil(note / 12)\n\n    let idx = (note + 1) % 12\n    return (this.NOTE[idx] + octave.toString())\n  }\n\n  allNotes () {\n    let notes:Note[] = []\n    for (let n = this.minNote; n < this.maxNote; n++) {\n      notes.push({\n        frequency: this.noteFrequency(n),\n        octave: Math.floor((n - 3) / 12) + 5,\n        name: Notes[(12 * 10 + n) % 12]\n      })\n    }\n    return notes\n  }\n}\n","import mod from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./SpectrumPresenter.vue?vue&type=style&index=0&id=064532f4&lang=scss&scoped=true&\"; export default mod; export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./SpectrumPresenter.vue?vue&type=style&index=0&id=064532f4&lang=scss&scoped=true&\"","import { SpectralExtractor } from '@/services/spectral-extractor/spectral-extractor'\nimport { DummySpectralExtractor } from '@/services/spectral-extractor/spectral-extractor-impl'\nimport { REGISTRY } from './registry'\nimport { container } from 'inversify-props'\nimport { AudioContextProviderImpl, AudioContextProvider } from '@/services/providers/context-provider'\nimport { SampleLoaderService } from '@/services/sample-loader/sample-loader'\nimport { SampleLoaderImpl } from '@/services/sample-loader/sample-loader-impl'\nimport { StoreImpl, Store, PreLoadedStore } from '@/services/store/store'\nimport { TimeExtractor } from '@/services/time-extractor/time-extractor'\nimport { DummyTimeExtractor } from '@/services/time-extractor/dummy-time-extractor'\nimport { DrawToolkit, DrawToolkitImpl } from '@/services/providers/draw-toolkit'\nimport { NoteFrequencyProvider, NoteFrequencyProviderImpl } from '@/services/providers/note-frequency'\nimport { Quantizer, QuantizerImpl } from '@/services/providers/quantizer'\nimport { FFTEssentia } from '@/services/providers/fft'\nimport { EssentiaTimeExtractor } from '@/services/time-extractor/essentia-time-extractor'\nimport { EssentiaSpectralExtractor } from '@/services/spectral-extractor/essentia-spectral-extractor'\n\nexport default function () {\n  container.addSingleton<SpectralExtractor>(EssentiaSpectralExtractor, REGISTRY.SpectralExtractor)\n  container.addSingleton<TimeExtractor>(EssentiaTimeExtractor, REGISTRY.TimeExtractor)\n  container.addSingleton<AudioContextProvider>(AudioContextProviderImpl, REGISTRY.AudioContextProvider)\n  container.addSingleton<NoteFrequencyProvider>(NoteFrequencyProviderImpl, REGISTRY.NoteFrequencyProvider)\n  container.addSingleton<SampleLoaderService>(SampleLoaderImpl, REGISTRY.SampleLoader)\n  container.addSingleton<Store>(PreLoadedStore, REGISTRY.Store)\n  container.addSingleton<DrawToolkit>(DrawToolkitImpl, REGISTRY.DrawToolkit)\n  container.addSingleton<Quantizer>(QuantizerImpl, REGISTRY.Quantizer)\n  container.addSingleton<FFTEssentia>(FFTEssentia, REGISTRY.FFT)\n};\n"],"sourceRoot":""}